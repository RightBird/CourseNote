
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Course Note for ZJU CS">
      
      
        <meta name="author" content="RightBird">
      
      
        <link rel="canonical" href="http://RightBird.io/CourseNote/%E5%A4%A7%E4%B8%89%E4%B8%8A/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/Network_Layer.html">
      
      
        <link rel="prev" href="The_Medium_Access_Control_Sublayer.html">
      
      
        <link rel="next" href="Transport_Layer.html">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Network Layer - CourseNote</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#network-layer" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../index.html" title="CourseNote" class="md-header__button md-logo" aria-label="CourseNote" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CourseNote
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Network Layer
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="暗色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="暗色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="亮色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="亮色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/RightBird/CourseNote" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CourseNote
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Grading%20Policy.html" class="md-tabs__link">
          
  
  
    
  
  课程笔记

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../C%2B%2B/C%2B%2B%E5%9F%BA%E7%A1%80/data_type.html" class="md-tabs__link">
          
  
  
    
  
  C++

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="CourseNote" class="md-nav__button md-logo" aria-label="CourseNote" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CourseNote
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/RightBird/CourseNote" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CourseNote
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    课程笔记
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    课程笔记
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    大二上
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    大二上
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    高级数据结构与算法分析
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    高级数据结构与算法分析
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Grading%20Policy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grading Policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%201%20---AVL%20Trees%2C%20Splay%20Trees%2C%20and%20Amortized%20Analysis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1 ---AVL Trees, Splay Trees, and Amortized Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%202%20---Red-Black%20Trees%20and%20B%2B%20Trees.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 2 ---Red-Black Trees and B+ Trees
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%203%20---Inverted%20File%20Index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 3 ---Inverted File Index
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%204%20---Leftist%20Heaps%20and%20Skew%20Heaps.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 4 ---Leftist Heaps and Skew Heaps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%205%20---Binomial%20Queue.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5 ---Binomial Queue
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%206%20---Backtracking.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 6 ---Backtracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%207%20---Divide%20and%20Conquer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 7 ---Divide and Conquer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%208%20---Dynamic%20Programming.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 8 ---Dynamic Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter%209%20---Greedy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 9 ---Greedy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter10%20---NP-Completeness.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter10 ---NP-Completeness
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter11%20---Approximation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter11 ---Approximation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter12%20---Local%20Search.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter12 ---Local Search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter13%20---Randomized%20Algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter13 ---Randomized Algorithm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter14%20---Parallel%20Algorithms.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter14 ---Parallel Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/Chapter15%20---External%20Sorting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter15 ---External Sorting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/%E4%B9%A0%E9%A2%98.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    习题
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    计算机组成
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    计算机组成
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter1%20%20Computer%20Abstractions%20and%20Technology.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter1  Computer Abstractions and Technology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter2%20%20Instructions%20Language%20of%20the%20Computer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter2  Instructions Language of the Computer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter3%20%20Arithmetic%20for%20Computer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter3  Arithmetic for Computer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter4%20The%20Processor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter4 The Processor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter5%20Large%20and%20Fast%20Exploiting%20Memory%20Hierarchy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter5 Large and Fast Exploiting Memory Hierarchy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/Chapter6%20Storage%20and%20other%20IO%20Topics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter6 Storage and other IO Topics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    软件安全原理与实践
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    软件安全原理与实践
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/Lab1/report.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab1
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/Lab2/Report.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/Lab3/Report.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/Lab4/Report.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab4
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8A/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/Final/Report.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Final
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    大二下
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    大二下
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    计算机体系结构
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    计算机体系结构
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Grading%20Policy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grading Policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/Cache.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cache
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    面向对象程序设计
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    面向对象程序设计
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/Grading%20Policy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grading Policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    数据库系统
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    数据库系统
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Grading%20Policy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grading Policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Relational%20model.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Relational Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/SQL.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Advanced%20SQL.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced SQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/E-R%20model.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    E-R model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Relational%20Database%20Design.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Relational Database Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Storage%20and%20File%20Structure.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Storage and File Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Indexing%20and%20Hashing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Indexing and Hashing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Query%20Processing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Query Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Query%20Optimization.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Query Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Transactions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transactions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Concurrency%20Control.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concurrency Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%A4%A7%E4%BA%8C%E4%B8%8B/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/Recovery%20System.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recovery System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    大三上
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    大三上
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1" >
        
          
          <label class="md-nav__link" for="__nav_2_3_1" id="__nav_2_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    计算理论
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    计算理论
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Sets_Relations_Language.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sets, Relations, and Language
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Regular_Language_and_Automata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regular Language and Automata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Context-free_Language_and_Pushdown%20Automata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context-free Language and Pushdown Automata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Turing%20Machine.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Turing Machine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E8%AE%A1%E7%AE%97%E7%90%86%E8%AE%BA/Undecidability.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Undecidability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    计算机网络
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    计算机网络
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Physical_Layer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Physical Layer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Data_Link_Layer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Link Layer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="The_Medium_Access_Control_Sublayer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MAC Sublayer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Network Layer
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Network_Layer.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Layer
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview-of-network-layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview of network layer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview of network layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#two-important-network-layerfunctions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Two Important Network LayerFunctions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-layer-design-issues" class="md-nav__link">
    <span class="md-ellipsis">
      
        Network Layer Design Issues
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#services-provided-to-the-transport-layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Services Provided to the Transport Layer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-circuit-vs-datagram-networks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Virtual-Circuit vs. Datagram Networks
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#routing-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Routing algorithms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Routing algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#static-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Static routing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-link-state-ls-routing-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Link-State (LS) Routing Algorithm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-distance-vector-dv-routing-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Distance Vector (DV) Routing Algorithm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ls-vs-dv" class="md-nav__link">
    <span class="md-ellipsis">
      
        LS vs DV
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hierarchical-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hierarchical Routing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadcast-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Broadcast Routing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multicast-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multicast Routing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anycast-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Anycast Routing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-network-layer-in-the-internet" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Network Layer in the Internet
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Network Layer in the Internet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ip-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      
        IP Protocol
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#control-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      
        Control Protocols
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routing-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      
        Routing Protocols
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpls-multiprotocol-label-switching" class="md-nav__link">
    <span class="md-ellipsis">
      
        MPLS (Multiprotocol Label Switching)
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Transport_Layer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transport Layer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Application_Layer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Application Layer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Network_Security.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    C++
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    C++
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    C++基础
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    C++基础
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../C%2B%2B/C%2B%2B%E5%9F%BA%E7%A1%80/data_type.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    数据类型
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../C%2B%2B/C%2B%2B%E5%9F%BA%E7%A1%80/Variable.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    变量
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    库函数
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    库函数
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../C%2B%2B/%E5%BA%93%E5%87%BD%E6%95%B0/iostream.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    iostream
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../C%2B%2B/%E5%BA%93%E5%87%BD%E6%95%B0/string.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    string
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    STL
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    STL
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../C%2B%2B/%E5%BA%93%E5%87%BD%E6%95%B0/STL/%E8%BF%AD%E4%BB%A3%E5%99%A8.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    迭代器
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../C%2B%2B/%E5%BA%93%E5%87%BD%E6%95%B0/STL/vector.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vector
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview-of-network-layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview of network layer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview of network layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#two-important-network-layerfunctions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Two Important Network LayerFunctions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-layer-design-issues" class="md-nav__link">
    <span class="md-ellipsis">
      
        Network Layer Design Issues
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#services-provided-to-the-transport-layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Services Provided to the Transport Layer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-circuit-vs-datagram-networks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Virtual-Circuit vs. Datagram Networks
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#routing-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      
        Routing algorithms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Routing algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#static-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Static routing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-link-state-ls-routing-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Link-State (LS) Routing Algorithm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-distance-vector-dv-routing-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Distance Vector (DV) Routing Algorithm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ls-vs-dv" class="md-nav__link">
    <span class="md-ellipsis">
      
        LS vs DV
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hierarchical-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hierarchical Routing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadcast-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Broadcast Routing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multicast-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multicast Routing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anycast-routing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Anycast Routing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-network-layer-in-the-internet" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Network Layer in the Internet
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Network Layer in the Internet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ip-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      
        IP Protocol
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#control-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      
        Control Protocols
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routing-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      
        Routing Protocols
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mpls-multiprotocol-label-switching" class="md-nav__link">
    <span class="md-ellipsis">
      
        MPLS (Multiprotocol Label Switching)
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="network-layer">Network Layer<a class="headerlink" href="#network-layer" title="Permanent link">&para;</a></h1>
<h2 id="overview-of-network-layer">Overview of network layer<a class="headerlink" href="#overview-of-network-layer" title="Permanent link">&para;</a></h2>
<h3 id="two-important-network-layerfunctions">Two Important Network LayerFunctions<a class="headerlink" href="#two-important-network-layerfunctions" title="Permanent link">&para;</a></h3>
<p>网络层的主要任务是将数据包（packet）从发送主机传送到接收主机。</p>
<p>每个路由器都有一个转发表(<strong>forwarding(internal, routing) table</strong>)。转发表通过数据包头中的目标地址(<strong>destination address</strong>)或所属连接标识(<strong>indication of connection</strong>)进行索引。</p>
<h4 id="forwarding">Forwarding<a class="headerlink" href="#forwarding" title="Permanent link">&para;</a></h4>
<p>路由器的主要功能。</p>
<ul>
<li>转发(forwarding)指在<strong>单台路由器</strong>内部，将数据包从入站链路转移至出站链路。</li>
<li>转发是 <strong>router-local操作</strong>。</li>
</ul>
<h4 id="routing">Routing<a class="headerlink" href="#routing" title="Permanent link">&para;</a></h4>
<p>为每一个路由器建立转发表</p>
<ul>
<li>路由涉及整个网络的路由器，它们通过路由协议(<strong>routing protocols</strong>)的集体交互确定数据包从源节点到目标节点传输的路径。路由算法决定了路由器转发表中插入的值。</li>
<li>路由是 <strong>network-wide</strong>过程。(可采用集中式/分布式)</li>
</ul>
<h3 id="network-layer-design-issues">Network Layer Design Issues<a class="headerlink" href="#network-layer-design-issues" title="Permanent link">&para;</a></h3>
<p>包括为传输层提供的服务以及网络的内部设计。</p>
<ul>
<li><strong>Store-and-forward Packet Switching</strong>: 数据包在路由器中存储，直至其完整到达且链路通过校验完成处理。随后它沿路径转发至下一台路由器，直至到达目标主机并完成交付。
  <img alt="4-1" src="pic/4-1.png" /></li>
</ul>
<h3 id="services-provided-to-the-transport-layer">Services Provided to the Transport Layer<a class="headerlink" href="#services-provided-to-the-transport-layer" title="Permanent link">&para;</a></h3>
<h4 id="design-goals">Design goals<a class="headerlink" href="#design-goals" title="Permanent link">&para;</a></h4>
<ul>
<li>服务应独立于路由技术</li>
<li>传输层应该与现有的路由器数量、类型、拓扑保持隔离</li>
<li>网络地址应该采用统一的编码方案</li>
</ul>
<h4 id="connection-oriented-connecitionless-service">Connection-oriented &amp; Connecitionless service<a class="headerlink" href="#connection-oriented-connecitionless-service" title="Permanent link">&para;</a></h4>
<p>争议焦点：网络层应提供面向连接服务还是无连接服务。</p>
<ul>
<li>internet community: Connectionless service</li>
<li>telephone company: Connection-oriented</li>
</ul>
<h4 id="implementation-of-connectionless-service">Implementation of Connectionless Service<a class="headerlink" href="#implementation-of-connectionless-service" title="Permanent link">&para;</a></h4>
<p>数据包被单独注入网络，并相互独立地进行路由。这些数据包(packet)通常被称为数据报(<strong>datagram</strong>)。</p>
<p>每个路由器都有一个<strong>转发表</strong>，每条表项由一对信息组成：目标地址及其对应的出站线路。<img alt="4-2" src="pic/4-2.png" /></p>
<h4 id="implementation-of-connection-oriented-service">Implementation of Connection-Oriented Service<a class="headerlink" href="#implementation-of-connection-oriented-service" title="Permanent link">&para;</a></h4>
<p>每个数据包都携带一个标识符，表明其所属的虚拟电路。</p>
<p>路由器A会为不同连接分配不同标识符，即使它们可能使用相同的虚拟电路——Lable Switching(<strong>MPLS</strong>, MultiProtocol LS)<img alt="4-3" src="pic/4-3.png" /></p>
<h3 id="virtual-circuit-vs-datagram-networks">Virtual-Circuit vs. Datagram Networks<a class="headerlink" href="#virtual-circuit-vs-datagram-networks" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Issue</th>
<th>Datagram Networks</th>
<th>Virtual-circut Network</th>
</tr>
</thead>
<tbody>
<tr>
<td>电路建立</td>
<td>不需要</td>
<td>需要</td>
</tr>
<tr>
<td>寻址方式</td>
<td>每个数据包包含完整的源地址和目的地址</td>
<td>每个数据包包含短的虚电路号</td>
</tr>
<tr>
<td>状态信息</td>
<td>路由器不维护连接状态信息</td>
<td>每个虚电路需要在路由器上占用连接表空间</td>
</tr>
<tr>
<td>路由方式</td>
<td>每个数据包独立路由</td>
<td>虚电路建立时选择路由；所有数据包遵循同一路由</td>
</tr>
<tr>
<td>路由器故障的影响</td>
<td>无，除了故障期间丢失的数据包</td>
<td>所有经过故障路由器的虚电路都会终止</td>
</tr>
<tr>
<td>服务质量</td>
<td>困难</td>
<td>容易（如果能为每个虚电路预先分配足够资源）</td>
</tr>
<tr>
<td>拥塞控制</td>
<td>困难</td>
<td>容易（如果能为每个虚电路预先分配足够资源）</td>
</tr>
</tbody>
</table>
<h2 id="routing-algorithms">Routing algorithms<a class="headerlink" href="#routing-algorithms" title="Permanent link">&para;</a></h2>
<p>在数据报中，最佳路由可能会在上一次使用而发生改变。而在虚电路中，只有在建立新虚电路时才对路由进行决策。</p>
<p>在设计中，理想的特性有：<strong>correctness</strong>, <strong>simplicity</strong>, <strong>robustness</strong>, <strong>stability</strong>, <strong>fairness</strong> and <strong>efficiency</strong>.</p>
<p>路由算法可以被分为全局路由(<strong>Global routing</strong>)算法和分布式(<strong>decentralized</strong>)算法：</p>
<ul>
<li>全局路由算法利用完整的全局网络来计算源节点和目标节点之间的least-cost路径。(<strong>LS</strong>(Link-state) 算法，适合小规模网络)</li>
<li>分布式算法，通过迭代和分布式的方式计算least-cost路径。(<strong>DV</strong>(Distance-vector)算法，更适合大规模网络)</li>
</ul>
<p>路由算法的第二种广泛分类方式是根据其静态或动态特性进行划分。</p>
<ul>
<li><strong>Static routing algorithms</strong>(non-adaptive): e.g.人工手动编辑路由器的转发表</li>
<li><strong>Dynamic routing algorithms</strong>(adaptive):  能响应网络变化，但更易受路由环路和路径振荡等问题影响</li>
</ul>
<h3 id="static-routing">Static routing<a class="headerlink" href="#static-routing" title="Permanent link">&para;</a></h3>
<p><strong>Example</strong></p>
<p><img alt="4-4" src="pic/4-4.png" /></p>
<h3 id="the-link-state-ls-routing-algorithm">The Link-State (LS) Routing Algorithm<a class="headerlink" href="#the-link-state-ls-routing-algorithm" title="Permanent link">&para;</a></h3>
<p>在 LS 算法中，网络拓扑结构和所有链路成本是已知的，即作为链路状态算法的输入参数。在实际实现上，通过让每个节点向网络中所有其他节点广播(<strong>broadcast</strong>)链路状态数据包来完成，每个链路状态数据包包含其连接链路的标识和成本。</p>
<ul>
<li>例如，Internet 的 <strong>OSPF</strong> 路由协议就是通过 LS 广播算法实现的。</li>
</ul>
<p>需要保证<u>所有节点对网络的认知完全一致且完整</u>。每个节点运行链路状态算法后，计算出的最小成本路径集与其他节点完全相同。</p>
<ul>
<li>比较有名的 LS 算法是 <strong>Dijkstra's</strong> 算法（计算一个节点到其他所有节点的least-cost路径）。</li>
</ul>
<p>这里需要用到的算法为最短路算法，通常路径的cost可以用以下数据来衡量：</p>
<ul>
<li>跳数 (number of hops)</li>
<li>延迟</li>
<li>距离</li>
<li>带宽</li>
<li>通信成本 (communication cost)</li>
<li>平均流量 (average traffic)</li>
</ul>
<p><strong>最优性原则</strong>：若路由器J位于路由器I到路由器K的最优路径上，则从J到K的最优路径也必经此路线。</p>
<h4 id="sink-tree">Sink Tree<a class="headerlink" href="#sink-tree" title="Permanent link">&para;</a></h4>
<p>目的地的 <strong>Sink Tree</strong> 是所有通往该目的地的最短路径的并集。</p>
<p>例如对于下图，Sink Tree 为：</p>
<ul>
<li>A→B→C→E</li>
<li>B→C→E</li>
<li>C→E</li>
<li>H→C→E</li>
<li>D→E</li>
<li>F→E</li>
<li>G→F→E (G→B→C→E)</li>
</ul>
<p><img alt="4-5" src="pic/4-5.png" /></p>
<p>根据最优性原则，每个节点的转发表只要记录对于每一个目的地的下一跳就可以了。</p>
<h4 id="dijkstra-algorithm">Dijkstra Algorithm<a class="headerlink" href="#dijkstra-algorithm" title="Permanent link">&para;</a></h4>
<p>用于求解单源最短路问题（所有边的权重必须为非负值），使用贪心算法。先把所有节点都标记为不确定tentative，其他节点的距离设为无穷大（源节点设为0）。</p>
<p>当不确定节点还存在时：</p>
<ul>
<li>从未确定节点里找出一个距离最近的 <code>n</code></li>
<li>对 <code>n</code> 的所有邻居节点 <code>v</code>：
  如果 <code>dist[n] + weight(n, v) &lt; dist[v]</code>，
  就更新 <code>dist[v]</code>，表示找到了更短的路径。</li>
<li>把节点 <code>n</code> 标记为“已确定”，不再改变它的距离。</li>
</ul>
<p><img alt="4-6" src="pic/4-6.png" /></p>
<p>在 Dijkstra 算法中，每 <span class="arithmatex">\(i\)</span> 轮需要搜索 <span class="arithmatex">\(n-i+1\)</span> 个节点，即一共需要搜索 <span class="arithmatex">\((n+1)n/2\)</span> 次。因此时间复杂度为 <span class="arithmatex">\(O(n^2)\)</span> 。</p>
<h4 id="the-oscillation-problem-with-the-ls-algorithm">The Oscillation Problem with the LS Algorithm<a class="headerlink" href="#the-oscillation-problem-with-the-ls-algorithm" title="Permanent link">&para;</a></h4>
<p>当多个节点根据相同的网络状态独立计算最短路径，并根据结果改变其链路代b价或转发方向时，整个网络可能进入一个<strong>反复改变、永不稳定的状态</strong>，这就是振荡问题。</p>
<p><img alt="4-7" src="pic/4-7.png" /></p>
<h3 id="the-distance-vector-dv-routing-algorithm">The Distance Vector (DV) Routing Algorithm<a class="headerlink" href="#the-distance-vector-dv-routing-algorithm" title="Permanent link">&para;</a></h3>
<p>DV算法具有以下三个特性： </p>
<ul>
<li><strong>Distributed</strong> : 每个节点从一个或多个直接邻居接收信息，执行计算后将结果分发回邻居节点。</li>
<li><strong>Iterative</strong> : 该过程持续进行直至邻居节点间不再交换信息，具有自终止特性。</li>
<li><strong>Asynchronous</strong> : 无需所有节点同步操作。</li>
</ul>
<blockquote>
<h4 id="bellman-ford-equation"><strong>Bellman-Ford Equation</strong><a class="headerlink" href="#bellman-ford-equation" title="Permanent link">&para;</a></h4>
<p>设 <span class="arithmatex">\(d_x(y)\)</span> 为从节点 <span class="arithmatex">\(x\)</span> 到节点 <span class="arithmatex">\(y\)</span> 的最小成本路径的成本。则最小成本由著名的&gt; <strong>Bellman-Ford</strong>方程关联：</p>
<div class="arithmatex">\[
d_x(y)=\min\{c(x,v)+d_v(y)\}
\]</div>
<p>其中 <span class="arithmatex">\(v\)</span> 取自与 <span class="arithmatex">\(x\)</span> 相邻的所有节点。</p>
<p><strong>Example</strong> <img alt="4-8" src="pic/4-8.png" /></p>
</blockquote>
<p>算法的基本思想是每个节点 <span class="arithmatex">\(x\)</span> 都对于所有 <span class="arithmatex">\(N\)</span> 个节点初始化 <span class="arithmatex">\(D_x(y)\)</span> 值，即从自身到节点 <span class="arithmatex">\(y\)</span> 的最小成本路径的估计值。用 <span class="arithmatex">\(\mathbf{D}_x(y)=[D_x(y): y\text{ in }N]\)</span> 表示节点 <span class="arithmatex">\(x\)</span> 的成本估计向量（距离向量）。在 DV 算法中，每个节点 <span class="arithmatex">\(x\)</span> 都需要维护以下信息：</p>
<ul>
<li>对于每一个邻居节点 <span class="arithmatex">\(v\)</span> ，维护 <span class="arithmatex">\(x\)</span> 到 <span class="arithmatex">\(v\)</span> 的直接距离 <span class="arithmatex">\(c(x,v)\)</span></li>
<li>维护成本估计向量，即 <span class="arithmatex">\(\mathbf{D}_x(y)\)</span></li>
<li>每一个邻居 <span class="arithmatex">\(v\)</span> 的成本估计向量 <span class="arithmatex">\(\mathbf{D_v(y)}\)</span></li>
</ul>
<p>当 <span class="arithmatex">\(x\)</span> 接收了来自任意邻居节点 <span class="arithmatex">\(v\)</span> 的新的距离向量，则保存 <span class="arithmatex">\(v\)</span> 的向量，并对应地使用 Bellmen-Ford 公式来更新自己的距离向量。
$$
D_x(y)=\min{c(x,v)+D_v(y)}
$$
若节点 <span class="arithmatex">\(x\)</span> 的距离向量因本次更新发生变化，则节点 <span class="arithmatex">\(x\)</span> 将向所有邻居发送更新后的距离向量，邻居节点据此更新自身的距离向量。</p>
<p>只要所有节点持续以异步方式交换距离向量，每个成本估计值 <span class="arithmatex">\(D_x(y)\)</span> 都将收敛至 <span class="arithmatex">\(d_x(y)\)</span>。</p>
<p><img alt="4-9" src="pic/4-9.png" /></p>
<h4 id="the-count-to-infinity-problem">The Count-to-Infinity Problem<a class="headerlink" href="#the-count-to-infinity-problem" title="Permanent link">&para;</a></h4>
<p>当节点 <span class="arithmatex">\(x\)</span> 告知节点 <span class="arithmatex">\(y\)</span> 存在某条路径时，节点 <span class="arithmatex">\(y\)</span> 无法判断自身是否位于该路径上。</p>
<p><img alt="4-10" src="pic/4-10.png" /></p>
<p>在(b)的第二行中，B未收到来自A的任何消息，但C声称拥有通往A的路径，因此B到A的延迟变为3。此时B并不知晓C的路径恰恰经过自身节点。</p>
<h3 id="ls-vs-dv">LS vs DV<a class="headerlink" href="#ls-vs-dv" title="Permanent link">&para;</a></h3>
<h4 id="message-complexity">Message Complexity<a class="headerlink" href="#message-complexity" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>LS</strong>: <span class="arithmatex">\(n\)</span> 个节点, <span class="arithmatex">\(E\)</span> 个连接，一共发送 <span class="arithmatex">\(O(nE)\)</span> 条消息</li>
<li><strong>DV</strong>: 只在邻居之间发送</li>
</ul>
<h4 id="speed-of-convergence">Speed of Convergence<a class="headerlink" href="#speed-of-convergence" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>LS</strong>: <span class="arithmatex">\(O(n^2)\)</span> 算法，需要 <span class="arithmatex">\(O(nE)\)</span> 条消息</li>
<li><strong>DV</strong>: 时间不确定，存在<strong>Count-to-Infinity</strong>问题</li>
</ul>
<h4 id="robustness">Robustness<a class="headerlink" href="#robustness" title="Permanent link">&para;</a></h4>
<p>（路由器故障时会发生什么）</p>
<ul>
<li><strong>LS</strong>: 节点可能广播错误链路成本；每个节点都只计算自己的路由表（只影响自己，鲁棒性强）</li>
<li><strong>DV</strong>: 节点可能广播错误链路成本；节点路由表被其他节点使用；错误在网络中传播（鲁棒性弱，容易振荡）</li>
</ul>
<h3 id="hierarchical-routing">Hierarchical Routing<a class="headerlink" href="#hierarchical-routing" title="Permanent link">&para;</a></h3>
<p>网络可能无法让每台路由器都存储所有其他路由器的条目。因此路由必须采用分层方式实现。使用分层路由时，路由器会被划分为若干区域(<strong>rigions</strong>)。</p>
<p>最常见的分层单位叫做 <strong>Autonomous System(AS)</strong>。每个路由器仅知道自身AS内数据包转发至目的地的完整细节，对其他AS的内部结构一无所知。</p>
<p><img alt="4-11" src="pic/4-11.png" /></p>
<p>同一个AS内的路由器使用相同的路由协议，即<strong>Intra-AS</strong>路由协议。不同的AS中可以使用不同的Intra-AS路由协议。</p>
<p>直接与其他AS的路由器连接的被称为 <strong>Gateway router</strong>(网关路由器)，比图上图中的1B和1C。</p>
<p>根据Kamoun and Kleinrock (1979)的发现，在有 <span class="arithmatex">\(N\)</span> 个路由器的网络结构中，最优的网络层级数是 <span class="arithmatex">\(\log N\)</span>。</p>
<h3 id="broadcast-routing">Broadcast Routing<a class="headerlink" href="#broadcast-routing" title="Permanent link">&para;</a></h3>
<p>在广播路由中，网络层提供将源节点发送的数据包传递至网络中所有其他节点的服务。</p>
<h4 id="uncontrolled-flooding">Uncontrolled flooding<a class="headerlink" href="#uncontrolled-flooding" title="Permanent link">&para;</a></h4>
<p>发送节点向每个目的地发送独立的数据包副本，是实现广播通信最简单直接的方式之。</p>
<p><strong>优点</strong>: 实现简单，不需要新的网络层路由协议</p>
<p><strong>缺点</strong>: 效率低；源节点需要完整的目标列表；Broadcast storm。</p>
<h4 id="controlled-flooding">Controlled flooding<a class="headerlink" href="#controlled-flooding" title="Permanent link">&para;</a></h4>
<p><strong>Sequence-number-controlled flooding</strong>。</p>
<ul>
<li>源节点将自身地址（或其他唯一标识符）及广播序列号放入广播数据包，随后将该数据包发送至所有邻居节点。</li>
<li>每个节点都维护着一份列表，记录其已接收、复制并转发的每个广播数据包的源地址和序列号。</li>
<li>当节点接收到广播数据包时，首先检查该数据包是否存在于列表中。若存在则丢弃；若不存在，则复制该数据包并转发至所有邻居节点。</li>
</ul>
<p><strong>Reverse Path Forwarding(RPF)</strong></p>
<p>当广播数据包到达路由器时，路由器会检查该数据包是否通过通常用于向广播源发送数据包的链路抵达。若属实，则该广播数据包极有可能遵循了从路由器出发的最佳路径，因而被认为是首个抵达该路由器的副本。在此情况下，路由器会将其副本转发至除原始链路外的所有链路。但若广播数据包通过非首选链路抵达，则会被视为可能的重复数据包而丢弃。</p>
<p><strong>优点</strong>: RPF仅需知道其单播最短路径上下一跳邻居节点。它仅利用该邻居的身份来决定是否泛洪接收到的广播数据包，无需记忆序列号。</p>
<p><img alt="4-12" src="pic/4-12.png" /></p>
<h4 id="spanning-tree">Spanning Tree<a class="headerlink" href="#spanning-tree" title="Permanent link">&para;</a></h4>
<p>生成树包含图中所有节点，且不包含环路。当源节点发送广播数据包时，会通过所有属于生成树的入链路发送该数据包。接收广播数据包的节点将转发该数据包至生成树中所有邻居节点。节点无需了解完整树结构，只需识别图中哪些邻居属于生成树邻居即可。</p>
<p>生成树方法的主要困难在于生成树的创建与维护。以下是基于中心的生成树构建方法：</p>
<ul>
<li>首先定义一个中心节点(<strong>rendezvous point/core</strong>)</li>
<li>节点向中心节点单播发送<strong>tree-join messages</strong>。树接入消息通过单播路由向中心转发，直至抵达已属于生成树的节点或到达中心节点。树接入消息所经过的路径定义了节点到中心节点的路径。</li>
</ul>
<p><img alt="4-13" src="pic/4-13.png" /></p>
<h3 id="multicast-routing">Multicast Routing<a class="headerlink" href="#multicast-routing" title="Permanent link">&para;</a></h3>
<p>向规模明确、数量庞大但相对于整个网络而言较小的群体发送消息。</p>
<p>在实际应用中，已采用两种方法来确定多播路由树(<strong>multicast routing tree</strong>)。</p>
<p><strong>Source-based tree</strong></p>
<p>为每个发送者（source）建一棵独立的多播树。</p>
<ul>
<li>
<p>为多播组中的每个源构建专属的多播路由树。</p>
</li>
<li>
<p>使用反向路径转发(RPF)算法构建从源 <span class="arithmatex">\(x\)</span> 出发的多播数据报的转发树。</p>
</li>
</ul>
<p><strong>Group-shared tree</strong></p>
<p>整个多播组（group）共用一棵树。</p>
<ul>
<li>类似于生成树广播，组共享树的多播路由基于构建一个包含所有连接至多播组的边缘路由器的树。</li>
<li>所有沿路径传递JOIN消息的路由器将会将接收到的多播数据包转发给发起多播加入请求的边缘路由器（中心型树）。</li>
</ul>
<h4 id="internet-multicast-routing">Internet Multicast Routing<a class="headerlink" href="#internet-multicast-routing" title="Permanent link">&para;</a></h4>
<p>在 Internet 中，每个多播组(multicast group) 都用一个 <strong>Class D IP 地址</strong> 表示。</p>
<p>组的成员关系由 <strong>IGMP(The Internet Group Management Protocol) 协议</strong> 管理。</p>
<p>Internet 中网络层的多播由两个部分组成：IGMP 和 多播路由协议。</p>
<p>IGMP只有三种消息类型，每种消息都包含一个IP数据报，其中<u>IP protocol number为2</u>，三种消息分别为：</p>
<ul>
<li><strong>membership-query message</strong>: 由路由器向所有主机广播，用于确定该接口上已加入的所有多播组成员。主机在首次加入多播组时，也可以主动生成成员查询消息，而无需等待路由器的查询。  </li>
<li><strong>membership-report message</strong>: 主机的响应。</li>
<li><strong>leave-group message</strong>: 可选的。当主机停止响应具有特定组地址的成员查询消息时，即表示其已不再属于该多播组。 </li>
</ul>
<p>Distance-vector multicast routing protocol (<strong>DVMRP</strong>) 实现了基于源的树结构，采用反向路径转发和剪枝机制。</p>
<p>Protocol-Independent Multicast (<strong>PIM</strong>)路由协议明确区分两种多播分发场景：PIM 密集模式是一种洪泛和剪枝的反向路径转发技术，其工作原理类似于 DVMRP；PIM 稀疏模式利用会合点（rendezvous points）建立多播分发树结构。</p>
<h3 id="anycast-routing">Anycast Routing<a class="headerlink" href="#anycast-routing" title="Permanent link">&para;</a></h3>
<ul>
<li>Unicast —— 单一目的地</li>
<li>Broadcast —— 到所有目标</li>
<li>Multicast —— 到一组目标</li>
</ul>
<p><strong>Anycast</strong>一种网络寻址与路由技术，<strong>多个服务器共享同一IP地址</strong>，路由到<strong>“最近”或最易达</strong>的服务器，依据路由协议（如BGP）实现。  </p>
<ul>
<li>因为这些服务器不在一个广播域内，所以不会引起IP地址冲突。</li>
<li>在仅仅配置相同IP外，还需要借助BGP协议进行地址宣告，通过BGP，各个站点向Internet宣告相同的AnyCast IP地址。</li>
</ul>
<p><img alt="4-14" src="pic/4-14.png" /></p>
<p>无需为任播设计新的路由方案，因为常规距离矢量和链路状态路由算法能够生成任播路由。例如，如果我们对组1的成员进行任播，他们都会被分配相同的地址“1”，而不是不同的地址。距离矢量路由将像往常一样传播路向信息，节点将选择到目的地“1”的最短路径。这将导致节点向最近的“1”实例发送数据。这一机制之所以有效，是因为路由协议未识别到存在多个“1”实例。</p>
<h2 id="the-network-layer-in-the-internet">The Network Layer in the Internet<a class="headerlink" href="#the-network-layer-in-the-internet" title="Permanent link">&para;</a></h2>
<p>Internet的网络层主要有3个组成部分：</p>
<ul>
<li>IP协议</li>
<li>Internet控制协议（包括 ICMP, DHCP, ARP)</li>
<li>Internet路由协议（包括 RIP, OSPF, BGP)</li>
</ul>
<h3 id="ip-protocol">IP Protocol<a class="headerlink" href="#ip-protocol" title="Permanent link">&para;</a></h3>
<h4 id="the-ipv4-datagram">The IPv4 Datagram<a class="headerlink" href="#the-ipv4-datagram" title="Permanent link">&para;</a></h4>
<p>IPv4报头有<strong>20个字节的固定部分</strong>和一个可变长度的可选部分。如下图所示，bits从左向头，从上向下传输。</p>
<p><img alt="" src="pic/4-15.png" /></p>
<p><strong>1. Version field(4bits)</strong></p>
<p>通过在每个数据报的起始位置加入版本信息，可以实现长时间跨度内的版本兼容与平滑过渡。</p>
<p><strong>2. IHL field(Header Length) (4 bits)</strong></p>
<p>以word为单位(4bytes)标记报头长度，4位的最大值位15，因此报头最长为60字节，即可选部分最长为40字节。
大多数IP报头都不包含可选部分，因此通常IP数据报的报头长度为20字节。</p>
<p><strong>3. The Different Service field(Type of Service) (8 bits)</strong></p>
<p>前6位用于标记数据报的服务类型，后2位用于指示明确的拥塞控制信号(<strong>explicit congestion indications</strong>)</p>
<ul>
<li>Real-time traffic(如IP电话应用) 或 non-real-time traffic(如FTP)</li>
</ul>
<p><strong>4. The Total Length field (16bits)</strong></p>
<p>数据报的总长度（包括<strong>报头和数据</strong>）。
理论上的最大值是 65535 字节(最大payload=65535-20=65,515)，但是实际上数据报长度很少超过1500字节。</p>
<p><strong>5. The Identification field (16 bits), flags (DF, MF), and fragment offset (13 bits)</strong></p>
<p>这三个字段与所谓的IP分片机制(<strong>IP fragmentation</strong>)相关。<u>一个数据包中的所有切片都有相同的identification field</u>。后16位的作用如下：</p>
<ul>
<li>未使用位 (1bit)</li>
<li>DF (1bit): 不切片。若为1则不允许切片，通常用于探测网络的MTU(Max Transsion Unit)</li>
<li>MF (1bit): 更多切片。若为1表示后面还有更多切片，<strong>若为0则表示是最后一个切片</strong>。</li>
<li>The Fragment Offset (13 bits): 一个数据报最多有8192个切片。</li>
</ul>
<p><strong>6. The TtL(Time to Live) field (8 bits)</strong></p>
<p><strong>每次数据包经过路由器处理时，该字段值减1</strong>。当TtL值减至0时，数据报会被丢弃，并向源主机发送警告。</p>
<p><strong>7. The Protocol field (8 bits)</strong></p>
<p>协议字段指示应将数据包交付给哪个传输协议:</p>
<ul>
<li>当值为<strong>6</strong>时，表明数据部分交由<strong>TCP</strong>协议处理。</li>
<li>当值为<strong>17</strong>时，表示数据交由<strong>UDP</strong>协议处理。</li>
</ul>
<p><strong>协议编号</strong>是连接网络层和传输层的纽带，而<strong>端口号</strong>则是连接传输层和应用层的媒介。</p>
<p><strong>8. The header checksum (16 bits)</strong></p>
<p>头部校验和通过将头部中的每两个字节视为一个数值，并使用<strong>反码</strong>运算对这些数值求和来计算。路由器为每个接收到的IP数据包计算头部校验和，若数据包头中的校验和与计算值不符，则检测出错误，通常会丢弃检测到错误的数据包。</p>
<p><u>由于TTL字段及可能的选项字段在传输过程中可能会发生变化，因此每个路由器在转发时都必须重新计算并存储校验和。</u></p>
<p><strong>9. The Source address and Destination address (each with 32 bit)</strong></p>
<p><strong>10. The Options field</strong></p>
<p><img alt="" src="pic/4-16.png" /></p>
<p><strong>11. Data (payload)</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>IPv4 要求主机必须能够接收至少 576 bytes 的 IP 数据报。</p>
</div>
<h4 id="packet-fragmentation">Packet Fragmentation<a class="headerlink" href="#packet-fragmentation" title="Permanent link">&para;</a></h4>
<p>不同网络的最大有效载荷容量(payload):</p>
<ul>
<li>Ethernet: 1500 bytes</li>
<li>802.11: 2304 bytes(加密前帧体的最大size)</li>
<li>IP: 65515 bytes</li>
</ul>
<p>解决方案</p>
<ol>
<li>确保数据包在传输过程中不发生碎片化：计算路径最大传输单元（Path MTU）</li>
<li>将数据包切割成多个切片(fragments)，作为独立的网络层数据包进行传输。切片重组方法有2种: Transparent fragmentation / Nontransparent fragmentation</li>
</ol>
<p><strong>Transparent fragmentation</strong></p>
<p>分片和重组都由中间网络（路由器）完成。实现简单但是存在问题：</p>
<ul>
<li>退出路由器必须能够识别全部碎片已接收完毕（例如采用计数字段或“数据包结束”标志位，如IP数据报中的“<strong>MF</strong>”位）</li>
<li>所有数据包必须通过同一路由器出口，以确保正确重组，路由器在此过程中受到限制。</li>
</ul>
<p><img alt="" src="pic/4-17.png" /></p>
<p><strong>Nontransparent fragmentation</strong></p>
<p>数据包一旦被分片，这些分片就独立传输，由目标主机在终点处重组。</p>
<p>非透明分段的主要优势在于降低路由器的处理负担</p>
<ul>
<li>IPv4协议即采用此方式。</li>
<li>完整的设计要求对分段进行编号，以确保能够准确还原原始数据流。</li>
</ul>
<p><img alt="" src="pic/4-18.png" /></p>
<p><strong>Example</strong></p>
<p>4000字节的数据报在MTU位1500字节的网络上传输。<img alt="" src="pic/4-19.png" /></p>
<p><strong>Path MTU dicovery</strong></p>
<p>现代互联网中采用的技术。该技术的优势在于源终端能够实时获知MTU。若网络路由器或路径MTU发生变化，系统会生成新的报错包，源终端则会动态调整传输路径参数。
然而，其缺点在于在探测路径的过程中可能引入额外的初始化延迟(<strong>added startup delays</strong>)，可能需要多次往返时延以完成路径探测。<img alt="" src="pic/4-20.png" /></p>
<h4 id="ipv4-addressing">IPv4 Addressing<a class="headerlink" href="#ipv4-addressing" title="Permanent link">&para;</a></h4>
<p>IPv4是32位地址空间。<u>IP地址实际上并不指向某一具体主机，而是指向网络接口(network interface)。</u>如果一台主机同时在两个网络上，则需要两个IP地址。</p>
<p>在实际使用中，大多数主机都在一个网络上工作，因此只需要1个IP地址。而路由器有多个接口，因此需要多个IP地址。</p>
<p>区别于以太网地址，IP地址采用层次结构设计。每个32位地址由顶部的可变长度网络部分(<strong>network portion</strong>)和底部的主机部分(<strong>host portion</strong>)组成。</p>
<p>IPv4地址采用点十进制表示法，如128.208.2.151。也可以使用十六进制表示: 80D00297。</p>
<p><img alt="" src="pic/4-21.png" /></p>
<p><strong>IP Prefix</strong> </p>
<p>用于表示<strong>IP 地址块</strong>，采用 IP address/length 的写法，其中 /N 被称为子网掩码(<strong>subnet mask</strong>)，如 /24 表示子网掩码位 255.255.255.0; 128.13.0.0/16 表示 128.13.0.0 到 128.13.255.255之间到IP地址。</p>
<p>Prefix的主要优势在于路由器可以仅根据IP地址的网络部分进行包转发，只要每个网络拥有唯一的地址块即可。</p>
<ul>
<li>更具体的前缀具有更长的前缀长度，因此对应的IP地址范围更小。</li>
<li>相反，较不具体的前缀长度较短，覆盖的IP地址范围更大。</li>
</ul>
<h5 id="subnet"><strong>Subnet</strong><a class="headerlink" href="#subnet" title="Permanent link">&para;</a></h5>
<p>按前缀进行路由需要网络中的所有主机共享相同的网络编号。随着网络规模扩大，此特性可能引发路由与管理上的难题。</p>
<p>解决方案是将地址块拆分为多个子网，用于内部通信，却对外表现为一个统一的网络，这一过程即子网划分（<strong>subnetting</strong>）。</p>
<p><img alt="4-22" src="pic/4-22.png" /></p>
<h5 id="ip-address-classes-historical">IP Address Classes - Historical<a class="headerlink" href="#ip-address-classes-historical" title="Permanent link">&para;</a></h5>
<p>在采用Classless InterDomain Routing(CIDR)之前，IP地址的网络部分长度局限于8、16或24比特，这种寻址方案被称为<strong>classful addressing</strong>。</p>
<p><img alt="4-23" src="pic/4-23.png" /></p>
<h5 id="cidr-classless-interdomain-routing"><strong>CIDR (Classless InterDomain Routing)</strong><a class="headerlink" href="#cidr-classless-interdomain-routing" title="Permanent link">&para;</a></h5>
<p>不再使用固定的类划分（Class A/B/C），而是允许 <strong>IP 前缀长度可变</strong>，根据实际需求灵活分配。</p>
<p>CIDR的实现需要两个关键的机制：</p>
<ul>
<li><strong>Subnetting</strong>: 划分IP前缀 </li>
<li><strong>Route aggregation</strong>: 将多个较小的前缀合并为一个较大的前缀  </li>
</ul>
<p>子网划分和路由聚合的设计过程统称为CIDR（Classless InterDomain Routing）</p>
<p><img alt="4-24" src="pic/4-24.png" /></p>
<blockquote>
<p><strong>Longest Matching Prefix Rule</strong></p>
<p>当一个目标地址匹配多条路由时，选择匹配位数最多的那一条路由（即最具体的网络）。<img alt="" src="pic/4-25.png" /></p>
</blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>特殊IP地址有：0.0.0.0表示本网络；255.255.255.255表示当前子网的所有主机，常应用于局域网的广播通信；127.0.0.1表示本地地址。</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Internet数据包中不会出现的私有地址：</p>
<p>10.0.0.0/8  10.0.0.0 - 10.255.255.255</p>
<p>172.16.0.0/12 172.16.0.0 - 172.31.255.255</p>
<p>192.168.0.0/16 192.168.0.0 -192.168.255.255</p>
</div>
<h5 id="natnetwork-address-translation"><strong>NAT(Network Address Translation)</strong><a class="headerlink" href="#natnetwork-address-translation" title="Permanent link">&para;</a></h5>
<p>为了解决IP地址资源有限的问题，主要采用两种解决方案：</p>
<ul>
<li><strong>DHCP(Dynamic Host Configuration Protocol)</strong>: 采用动态IP分配机制，在计算机连接网络时动态分配IP地址，网络不再使用时回收该IP地址</li>
<li><strong>NAT(Network Address Translation)</strong>: 通过少量的外部IP地址，实现多个内部主机的通信</li>
</ul>
<p><img alt="" src="pic/4-26.png" /></p>
<p>NAT转换表中不仅包含<strong>端口号</strong>，还包括表项中的<strong>IP地址</strong>。NAT路由器能够作为单一设备向外部网络表现，具有唯一的IP地址。</p>
<p>端口实质上是额外的16位地址，用于识别不同进程接收的入站数据包。0到1023端口专为知名服务保留，其中端口80为Web服务器所使用的默认端口。</p>
<p><img alt="" src="pic/4-27.png" /></p>
<p>NAT存在一些问题：</p>
<ul>
<li><u>端口号应仅用于进程寻址</u>，而非主机寻址。</li>
<li>路由器应仅处理第3层（网络层）的数据包。</li>
<li>NAT协议违反了所谓的端到端（end-to-end）原则，即主机之间应直接通信，不应有中间节点修改IP地址和端口号。</li>
<li>NAT将互联网从一个无连接网络转变为一种特殊的面向连接的网络。如果NAT设备崩溃且丢失其映射表，所有连接将被中断。</li>
<li>NAT违反了协议分层的基本原则：第k层不应对第k+1层在负载（payload）字段中存放的内容做任何假设。</li>
</ul>
<h5 id="dhcp"><strong>DHCP</strong><a class="headerlink" href="#dhcp" title="Permanent link">&para;</a></h5>
<p><img alt="" src="pic/4-28.png" /></p>
<h4 id="ipv6-addressing">IPv6 Addressing<a class="headerlink" href="#ipv6-addressing" title="Permanent link">&para;</a></h4>
<p>IPv6使用128位地址。IPv6 与 IPv4 不兼容，但与其他辅助互联网协议兼容，包括 TCP、UDP、ICMP、IGMP。</p>
<p>IPv6的主要特性有：</p>
<ul>
<li>IPv6 地址比 IPv4 地址更长。</li>
<li>简化后的报头仅包含 7 个字段（IPv4 为 13 个字段）。此更改使路由器能够更快地处理数据包，从而提高吞吐量并降低延迟。</li>
<li>更好地支持选项 → 加快数据包处理速度。</li>
<li>安全性。</li>
<li>服务质量 (QoS)。</li>
</ul>
<h5 id="ipv6-datagram-header"><strong>IPv6 Datagram Header</strong><a class="headerlink" href="#ipv6-datagram-header" title="Permanent link">&para;</a></h5>
<p><img alt="" src="pic/4-29.png" /></p>
<p><strong>1. Version field (4 bits)</strong></p>
<p>IPv6 为 6，IPv4 为 4</p>
<p><strong>2. Difference Services field (8 bits)</strong></p>
<p>低 2 位用于指示显式拥塞情况。</p>
<p><strong>3. Flow Label field (20 bits)</strong></p>
<p>当出现带有非零<strong>流标签</strong>的数据包时，所有路由器都可以在内部表中查找该数据包，以确定它需要何种特殊处理。流标签是数据报网络的灵活性和虚拟电路网络的保障。</p>
<p><strong>4. Payload length field (16 bits)</strong></p>
<p>指示 40 字节头部之后有多少字节。</p>
<p><strong>5. Next Header field (8 bits)</strong></p>
<p>指示要将数据包传递给哪个传输协议处理程序（例如：TCP、UDP）。
此字段使用与 IPv4 头部中的协议字段相同的值。</p>
<p><strong>6. Hop Limit field (8 bits)</strong></p>
<p>与 IPv4 中的<strong>TtL</strong>字段相同。</p>
<p><strong>7. Source address and Destination address fields (each with 128 bits or 16 bytes)</strong></p>
<h5 id="ipv6-address"><strong>IPv6 Address</strong><a class="headerlink" href="#ipv6-address" title="Permanent link">&para;</a></h5>
<p>IPv6 地址由八组四位十六进制数字组成，组与组之间用冒号分隔。</p>
<ul>
<li>如8000:0000:0000:0123:4567:89AB:CDEF</li>
</ul>
<p>由于许多地址中包含大量0，因此允许通过以下三种来优化表示：</p>
<ul>
<li>可以省略组前导0，因此 0123 可以写成123</li>
<li>可以用一对冒号替换一组或多组 16 位零。如8000::123:4567:89AB:CDER</li>
<li>IPv4 地址可以写成一对冒号和一个旧的点分十进制数。</li>
</ul>
<p>相比于IPv4，IPv6数据报去除了几个字段：</p>
<ul>
<li>分片/重组：IPv6 不允许在中间路由器进行分片和重组；这些操作只能在源和目标端执行。分片和重组是一个耗时的操作；从路由器中移除此功能可以加快网络内的 IP 转发速度。如果路由器收到的 IPv6 数据报过大，无法通过出站链路转发，路由器会直接丢弃该数据报，并向发送方发送“数据包过大”的 ICMP 错误消息。</li>
<li>没有header checksum：因为互联网层的传输层（例如 TCP 和 UDP）和数据链路层（例如以太网）协议已经执行了校验和，所以网络层不再需要此功能。由于 IPv4 报头包含 TTL 字段，因此需要在每个路由器上重新计算 IPv4 报头校验和。如果没有校验和，处理 IP 数据包的速度会更快。</li>
<li>没有Options：移除可选字段后，IP 报头长度固定为 40 字节。</li>
</ul>
<h5 id="ipv6-extension-headers"><strong>IPv6 Extension Headers</strong><a class="headerlink" href="#ipv6-extension-headers" title="Permanent link">&para;</a></h5>
<p>IPv6 引入了（可选）扩展头的概念。每个扩展头都是可选的，但如果存在多个扩展头，它们必须紧跟在固定头部之后，最好按照列出的顺序排列。</p>
<p>每个扩展头都编码为一个 (Type, Length, Value) 元组:</p>
<ul>
<li><strong>Type</strong>是一个 1 字节的字段，用于指示该扩展头属于哪个选项。前 2 位告诉不知道如何处理该选项的路由器该怎么做。选项包括：跳过该选项，丢弃数据包；丢弃数据包并发送 ICMP 数据包；以及丢弃数据包但不为组播地址发送 ICMP 数据包。</li>
<li><strong>Length</strong>是一个 1 字节的字段，用于指示扩展头的值的长度（0 到 255 字节）。</li>
<li><strong>Value</strong>是所需的任何信息，最多 255 字节。</li>
</ul>
<p>各拓展头通过Next Header字段串成一条链。</p>
<p>常见 IPv6 扩展头类型有：</p>
<ul>
<li><strong>The hop-by-hop header</strong>: 用于存储路径上所有路由器必须检查的信息。</li>
<li><strong>The destination options header</strong></li>
<li><strong>The routing header</strong>: 列出到达目标地址途中必须访问的一个或多个路由器。它与 IPv4 的loose source routing非常相似。</li>
<li><strong>The fragmentation header</strong>: 类似IPv4处理分片。但是在IPv6中，只有源主机可以对数据包进行分片。</li>
<li><strong>The authentication header</strong>: 提供一种机制，数据包的接收者可以通过该机制确认数据包的发送者。</li>
<li><strong>The encrypted security payload</strong>: 加密数据包的内容，以便只有预期的接收者才能读取。</li>
</ul>
<h5 id="transitioning-from-ipv4-to-ipv6"><strong>Transitioning from IPv4 to IPv6</strong><a class="headerlink" href="#transitioning-from-ipv4-to-ipv6" title="Permanent link">&para;</a></h5>
<p>RFC 4213 描述了两种方法：</p>
<ul>
<li><strong>IPv6-capable nodes</strong>: 一种双栈(<strong>dual-stack</strong>)方法，要求IPv6节点也具有完整的 IPv4 实现。IPv6 数据报中的一些 IPv6 特有字段将会丢失。<img alt="" src="pic/4-30.png" /></li>
<li><strong>Tunneling</strong>: 将整个 IPv6 数据报放入 IPv4 数据报的数据（payload）字段中。IPv4 网络只看到封装后的 IPv4 包，因此隧道内部的网络设备无法对隧道内的 IPv6 数据包进行处理或访问。（但 VPN 可以将这种限制转化为优势）<img alt="" src="pic/4-31.png" /></li>
</ul>
<h3 id="control-protocols">Control Protocols<a class="headerlink" href="#control-protocols" title="Permanent link">&para;</a></h3>
<p>除了用于数据传输的 IP 协议之外，互联网还有几个用于网络层配套的控制协议:</p>
<ul>
<li>IPv4: ICMP, ARP, DHCP</li>
<li>IPv6: ICMP, NDP(Neighbor Discovery Protocol), DHCP</li>
</ul>
<h4 id="icmpinternet-control-message-protocol">ICMP(Internet Control Message Protocol)<a class="headerlink" href="#icmpinternet-control-message-protocol" title="Permanent link">&para;</a></h4>
<p>ICMP 最典型的用途是<strong>错误报告</strong>。</p>
<p>ICMP 通常被认为是 IP 协议的一部分，但从架构上看，它位于 IP 协议之上，因为 <u>ICMP 消息包含在 IP 数据报中。</u>IP 数据报头的 <strong>Protocol 字段值为 1</strong> 表示这是一个 ICMP 数据报。ICMP 消息包含type字段和code字段，并包含 IP 数据报的头部和前 8 个字节。</p>
<p><img alt="4-32" src="pic/4-32.png" /></p>
<h5 id="use-of-icmp"><strong>Use of ICMP</strong><a class="headerlink" href="#use-of-icmp" title="Permanent link">&para;</a></h5>
<p><strong>Ping</strong></p>
<p>通过发送<strong>type 8 code 0</strong>的ICMP消息实现的，目标主机收到消息后会返回一个<strong>type 0 code 0</strong>的ICMP消息回复。</p>
<p><strong>Tracert</strong></p>
<p>用于确定源主机和目标主机之间路由器的名称和地址，实现流程如下：</p>
<ul>
<li>源主机上的 Tracert 程序向目标主机发送一系列普通的 IP 数据报，每个数据报都携带一个 UDP 段，其中<strong>包含一个不常见的UDP 端口号</strong>。第一个数据报的 TTL 为 1，第二个为 2，第三个为 3，依此类推。源主机还会为每个数据报启动计时器。</li>
<li>当第 n 个数据报到达第 n 个路由器时，第 n 个路由器发现该数据报的 TTL 已过期。根据 IP 协议规则，路由器丢弃该数据报，并向源发送 ICMP 警告消息(<strong>type 11 code 0</strong>)，<u>该警告消息包含路由器的名称及其 IP地址。</u></li>
<li>当 ICMP 消息返回源端时，源端从计时器获取往返时间，并从 ICMP 消息中获取第 n 个路由器的名称和 IP 地址。</li>
<li>由于该数据报包含一个端口号不常见的 UDP 段，目标主机会向源端发送一个端口不可达的 ICMP 消息(<strong>type 3 code 3</strong>)。当源端收到此 ICMP 消息时，它知道无需发送额外的探测数据包。</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>标准的 Tracert 程序实际上发送的是三组具有相同 TTL 值的数据包；因此，Tracert 输出对于每个 TTL 值都会提供三个结果。</p>
</div>
<h4 id="arp-the-address-resolution-protocol">ARP (The Address Resolution Protocol)<a class="headerlink" href="#arp-the-address-resolution-protocol" title="Permanent link">&para;</a></h4>
<p>ARP 查询数据包的目的是查询子网上的所有其他节点，以确定与待解析的 IP 地址对应的 MAC 地址。</p>
<blockquote>
<p><strong>Example</strong></p>
<p>主机 1 上的用户如何向网络上的主机 2 上的用户发送数据包。</p>
<ol>
<li>查找主机 2 的 IP 地址，假设主机 1 知道主机 2 的名称。此查找由 DNS（第 7 章）执行。</li>
<li>主机 1 在以太网上输出一个广播数据包，询问谁拥有 IP 地址 192.32.65.5。此时发送目标是一个<strong>特殊的MAC地址: ff:ff:ff:ff:ff:ff(即所有主机)</strong></li>
<li>只有主机 2 会响应其以太网地址 (E2)。这样，主机 1 就能获知 IP 地址 192.32.65.5 位于以太网地址 (E2) 上。</li>
<li>主机 1 构建一个发往 E2 的以太网帧地址，将 IP 数据包（地址为 192.32.65.5）放入有效载荷字段，然后将其发送到以太网端口。</li>
</ol>
<p><img alt="" src="pic/4-33.png" /></p>
</blockquote>
<h5 id="various-optimizations-of-arp">Various Optimizations of ARP<a class="headerlink" href="#various-optimizations-of-arp" title="Permanent link">&para;</a></h5>
<p><strong>1. Cache</strong></p>
<p>一旦某台机器运行了 ARP 请求，它会将结果缓存起来，以便在需要时再次联系同一台机器。每个节点（主机和路由器）的内存中都有一个 <strong>ARP 表</strong>，其中包含 IP 地址到 MAC 地址的映射。ARP 表包含一个<strong>生存时间 (TTL) 值</strong>，该值指示每个映射何时从表中删除。</p>
<p>在许多情况下，主机 2 需要发送回复，这迫使它也运行 ARP 请求来确定发送方的以太网地址。可以通过让主机 1 将其 IP 地址到以太网地址的映射包含在 ARP 数据包中来避免这种 ARP 广播。当 ARP 广播到达主机 2 时，该映射对 (192.32.65.7, E1) 将被添加到主机 2 的 ARP cache中。实际上，以太网上的所有机器都可以将此映射添加到它们的 ARP 缓存中。</p>
<p><strong>2. The default gateway</strong></p>
<p>如图，假设主机 1 要向网络EE上的主机 4 (192.32.63.8) 发送数据包。主机 1 会发现目标 IP 地址不在 CS 网络上。它知道要将所有此类网络外流量发送到默认网关（路由器）。按照惯例，默认网关的地址是网络上<strong>最低</strong>的。发送的过程如下：</p>
<ul>
<li>Step1: 如果主机 1 不知道 IP 地址为 (192.32.65.1) 的默认网关（路由器）的 MAC 地址，它会通过发送 ARP 广播数据包来发现它，并找到 MAC 地址（以太网地址）为 E3。</li>
<li>Step2: 主机 1 向默认网关发送一个帧（源地址 192.32.65.7，E1；目标地址 192.32.63.8，E3）。路由器收到该帧后，将其交给 IP 软件处理。路由器根据网络掩码得知该数据包应发送到 EE 网络，最终到达主机 4。</li>
<li>Step3: 如果路由器不知道主机 4 的 MAC 地址，它将再次使用 ARP 协议（主机 4 的 MAC 地址为 E6）。</li>
<li>Step4: 路由器发送一个帧（源地址 192.32.65.7，E4；目标地址 192.32.63.8，E6）。</li>
</ul>
<p><img alt="" src="pic/4-34.png" /></p>
<p><img alt="" src="pic/4-35.png" /></p>
<p><strong>3. Proxy ARP</strong></p>
<p>主机 1 发送 ARP 后，由路由器代替主机 4 回应 ARP，即提供自己的 MAC 地址，让主机 1 以为主机 4 就在本地网络，从而实现跨网段通信。(<u>主机 4 不会直接回复 APR  请求，因为路由器不会转发以太网层的广播</u>)</p>
<h5 id="arp-vs-dns">ARP vs. DNS<a class="headerlink" href="#arp-vs-dns" title="Permanent link">&para;</a></h5>
<ul>
<li>ARP 仅将同一子网上的节点的 IP 地址解析为 MAC 地址</li>
<li>DNS 将互联网上任何位置的主机名解析为 IP 地址。</li>
</ul>
<p>ARP 被视为一种跨越链路层和网络层的协议。</p>
<h3 id="routing-protocols">Routing Protocols<a class="headerlink" href="#routing-protocols" title="Permanent link">&para;</a></h3>
<p>本部分主要介绍当今Internet中使用的两种 intra-AS 路由协议(<strong>RIP</strong>, <strong>OSPF</strong>) 和一种 inter-AS 路由协议(<strong>BGP</strong>)。</p>
<h4 id="routing-in-the-internet">Routing in the Internet<a class="headerlink" href="#routing-in-the-internet" title="Permanent link">&para;</a></h4>
<p>在实际的Internet中，如果将网络简单地视为一组互连的路由器，所有路由器都执行相同的路由算法(LS/DV)来计算整个网络中的路由路径会存在以下问题：</p>
<ul>
<li><strong>Scale</strong>: LS 算法需要存储所有路由信息，并在所有路由器之间广播 LS 更新；而 DV 算法在大量路由器之间迭代，肯定无法收敛。</li>
<li><strong>Administrative autonomy</strong>: 组织应该能够按照自己的意愿运行和管理其网络，同时仍然能够将其网络连接到其他外部网络。</li>
</ul>
<p>这些问题可以通过将路由器组织成自治系统(<strong>Autonomous Systems, AS</strong>)，即使用分层路由。</p>
<ul>
<li>同一自治系统 (AS) 内的路由器都运行相同的路由算法（例如，LS 或 DV 算法），并且彼此之间共享信息。(Intra-autonomous system routing protocol)</li>
<li>为了将不同的 AS 连接起来，一个 AS 中的一个或多个路由器将承担额外的任务：负责将数据包转发到 AS 外部的目标地址。这些路由器被称为 <strong>gateway routers</strong></li>
</ul>
<p>Internet使用两级路由算法：</p>
<ul>
<li>在每个网络内部，使用 intradomain/interior gateway protocol 进行路由(Distance vector routing, Link state routing)</li>
<li>在组成 internet 的各个网络之间，使用 interdomain/exterior gateway proticol 进行路由。</li>
</ul>
<p><strong>不同网络可能使用不同的 intradoamin protocols，但是一定使用相同的 interdomain protocols</strong>。在 Internet中，interdomain routing protocol 被称为 <strong>BGP</strong>(Border Gateway Protocol)。</p>
<p>在网络层，Internet 可以被视为相互连接的网络或 AS 的集合: </p>
<ul>
<li>
<p>没有固定的结构，但存在几个主要的骨干网。这些骨干网由高带宽线路和高速路由器构成。其中最大的骨干网被称为一级网络。</p>
</li>
<li>
<p>连接到骨干网的是互联网服务提供商 (<strong>Internet Service Providers, ISP</strong>)，它们为家庭和企业提供互联网接入；此外还有数据中心和托管机房，这些设施内装满了服务器；以及区域性（中级）网络。</p>
</li>
<li>
<p>连接到区域性网络的是更多的 ISP、许多大学和公司的局域网 (LAN) 以及其他边缘网络。</p>
</li>
</ul>
<p>将整个互联网连接在一起的是网络层协议，即 IP（<strong>Internet Protocol</strong>）。</p>
<ul>
<li>理论上，IP 数据包每个最大可达 64 KB，但实际上它们通常不超过 1500 字节（以便能够放入一个以太网帧中）。</li>
</ul>
<p><img alt="" src="pic/4-36.png" /></p>
<blockquote>
<p><strong>Routers vs Switches(Bridges)</strong></p>
<ul>
<li>路由器会从帧中提取数据包，并根据数据包中的网络地址决定其发送目的地。</li>
<li>交换机（或网桥）则会根据数据包的 MAC 地址传输整个帧。交换机无需了解用于交换数据包的网络层协议，而路由器则需要。</li>
</ul>
<p>网桥主要用于在链路层连接相同类型的网络，而路由器则用于在网络层连接不同的网络。</p>
</blockquote>
<h4 id="rip-routing-information-protocol">RIP (Routing Information Protocol)<a class="headerlink" href="#rip-routing-information-protocol" title="Permanent link">&para;</a></h4>
<p>RIP是一种 DV 协议。</p>
<p>RIP使用跳数(<strong>hop count</strong>)来计算成本。最大的路径成本被限制在15，因此RIP只能用在小型的AS中。</p>
<p>在RIP中，路由使用 <strong>RIP response message</strong> 大约每30秒与邻居交换路由信息。</p>
<ul>
<li>路由器或主机发送的响应消息包含自治系统内最多 15 个目标子网的列表，以及发送方到每个子网的距离。</li>
<li>回复的消息本称为 <strong>RIP advertisement</strong></li>
</ul>
<p><u>RIP 是一种基于 <strong>UDP</strong> 的应用层协议。</u>路由器之间通过 UDP 协议，使用 <strong>520</strong> 端口相互发送 RIP 请求和响应消息。</p>
<p><strong>Example</strong></p>
<p><img alt="" src="pic/4-37.png" /><img alt="" src="pic/4-38.png" /><img alt="" src="pic/4-39.png" /></p>
<h4 id="ospf-open-shortest-path-first">OSPF (Open Shortest Path First)<a class="headerlink" href="#ospf-open-shortest-path-first" title="Permanent link">&para;</a></h4>
<p>OSPF是一种网关内路由协议(<strong>Interior Gateway Routing Protocol</strong>)。</p>
<p>OSPF及其密切相关的IS-IS协议通常部署在上层ISP（互联网服务提供商）中，而RIP则部署在下层ISP和企业网络中。</p>
<p>OSPF本质上是一种链路状态协议(<strong>link-state protocol</strong>)，它利用链路状态信息的泛洪和Dijkstra最短路径算法。</p>
<ul>
<li>使用OSPF时，路由器会构建整个自治系统的完整拓扑图。然后，路由器在本地运行Dijkstra最短路径算法，以确定到所有子网的最短路径树，并将自身作为根节点。</li>
<li>即使链路状态没有改变，OSPF也会定期（至少每30分钟一次）广播链路状态。</li>
<li>OSPF通告包含在OSPF消息中，这些消息直接由 <strong>IP</strong> 传输，IP协议号为89。</li>
<li>如果找到多条长度相同的路径。在这种情况下，OSPF 会记住一组最短路径，并在数据包转发过程中将流量分配到这些路径上。(<strong>ECMP</strong>, Equal Cost MutiPath)</li>
</ul>
<p><strong>OSPF Cost Table</strong><img alt="" src="pic/4-40.png" /></p>
<p>互联网中的许多自治系统 (AS) 本身规模庞大，为了在这种规模下运行，OSPF 允许将 AS 划分为编号区域(<strong>numbered areas</strong>)，其中一个区域是一个网络或一组连续的网络，即分层 OSPF 路由(<strong>hierarchical OSPF routing</strong>):</p>
<ul>
<li>一个区域被认为是一个单独的网络</li>
<li>在区域外部，其目标地址可见，但其拓扑结构不可见。</li>
<li>完全位于区域内的路由器称为内部路由器。</li>
</ul>
<p>每个 AS 都有一个<strong>骨干区域(backbone area</strong>)，被称为区域0(<strong>area 0</strong>)</p>
<ul>
<li>这个区域里的路由器被称为<strong>骨干路由器(backbone routers</strong>)</li>
<li>所有区域都连接到骨干区域（可能通过隧道），因此可以通过骨干区域从 AS 中的任何区域访问 AS 中的任何其他区域。</li>
<li>与其他区域一样，骨干区域的拓扑结构在骨干区域外部不可见。</li>
</ul>
<p>连接到两个或多个区域的每个路由器称为区域<strong>边界路由器(area border router)</strong>。它也必须是骨干区域的一部分。</p>
<ul>
<li>区域边界路由器的职责是汇总一个区域内的目的地信息，并将此汇总信息注入到与其相连的其他区域中。</li>
<li>此汇总信息包含成本信息，但不包含区域内拓扑结构的全部细节。</li>
<li>如果一个区域外只有一个边界路由器，则甚至无需传递汇总信息。这种区域称为<strong>末梢区域(stub area)</strong>。</li>
</ul>
<p>AS 边界路由器会将指向其他 AS 上外部目的地的路由注入到该区域内。然后，这些外部路由器会显示为可以通过 AS 边界路由器以一定成本到达的目的地。</p>
<p><img alt="" src="pic/4-41.png" /></p>
<p>一个区域内的每个路由器都拥有相同的链路状态数据库，并运行相同的最短路径算法。<strong>区域边界路由器</strong>需要其连接的所有区域的数据库，并且必须为每个区域<strong>分别</strong>运行最短路径算法。</p>
<p>对于位于不同区域的源和目标，跨区域路由必须从源到骨干网，穿过骨干网到达目标区域，然后再到达目标区域。</p>
<p>到外部目标的路由可能包含从 AS 边界路由器到外部路径的外部开销。</p>
<p>局域网 (LAN) 上的每个路由器都与其他所有路由器通信效率低下。为了避免这种情况，会选择一个路由器作为指定路由器(<strong>designed router</strong>)。它充当代表 LAN 的单一节点。同时，始终保持备用指定路由器(<strong>backup designed router</strong>)处于最新状态，以便在主指定路由器发生故障需要立即更换时，能够轻松完成切换。</p>
<p><strong>OSPF Messages</strong></p>
<p><img alt="" src="pic/4-42.png" /></p>
<p>正常运行期间，每个路由器都会定期向其所有相邻路由器发送链路状态更新 (LINK STATE UPDATE) 消息。这些消息会收到确认，以确保其可靠性。每条消息都有一个序列号，因此路由器可以判断收到的链路状态更新消息(LINK STATE UPDAT)是比它当前收到的消息更旧还是更新。</p>
<h4 id="bgp-border-gateway-protocol">BGP (Border Gateway Protocol)<a class="headerlink" href="#bgp-border-gateway-protocol" title="Permanent link">&para;</a></h4>
<p>BGP是网关外路由协议(Exterior Gateway Routing Protocol)，是当今Internet中使用的标准 <strong>inter-AS</strong> 路由协议。</p>
<p><u>BGP是一种基于<strong>策略(policies)</strong>而非最小距离的<strong>DV路由协议</strong>。</u>连接通常通过IXP（Internet eXchange Points）的链路建立，许多ISP都通过链路连接到IXP，以便与其他ISP互联。</p>
<ul>
<li>如果客户仅连接到一个ISP，则无需运行BGP，因为它是一个末端网络，仅通过一条链路连接到互联网的其他部分。</li>
<li>一些公司网络连接到多个ISP（<strong>multihoming</strong>）。在这种情况下，公司网络很可能运行域间路由协议（例如BGP），以告知其他AS哪些地址应该通过哪些ISP链路访问。</li>
</ul>
<p><strong>BGP 在 AS 层选择要遵循的路径，而 OSPF 在每个 AS 层选择路径。</strong></p>
<p><img alt="" src="pic/4-43.png" /></p>
<p>在 BGP 中，路由器之间通过<strong>端口 179 建立的半永久性(semipermanent) TCP 连接</strong>交换路由信息。</p>
<ul>
<li>每个自治系统 (AS) 内都存在一个 TCP 连接网。</li>
<li>在 BGP 中，目标地址不是主机，而是 CIDR 化的前缀(<strong>CIDRized prefix)</strong>，每个前缀代表一个子网或一组子网。</li>
</ul>
<p><img alt="" src="pic/4-44.png" /></p>
<p>当位于任何自治系统 (AS) 中网关路由器接收到通过 eBGP 学习到的前缀时，网关路由器会使用其 iBGP 会话将这些前缀分发给 AS 中的其他路由器。当路由器（无论是否为网关）学习到新的前缀时，它会在其转发表中为该前缀创建一个条目。</p>
<p>在 BGP 中，自治系统由其全球唯一的自治系统编号 (<strong>ASN</strong>, autonomous system number)标识。(AS 编号与 IP 地址一样，由 ICANN 区域注册机构分配)</p>
<p><strong>在 BGP 术语中，前缀及其属性被称为路由。</strong>因此，BGP 对等体之间会相互通告路由。</p>
<p><strong>BGP Route Advertising</strong></p>
<p>不同的参与方，例如互联网服务提供商 (ISP)，被称为自治系统 (AS)。自治系统的边界路由器会相互通告 BGP 路由。路由通告(Route Advertising)包含 <strong>IP 前缀、AS 路径和下一跳</strong>。</p>
<ul>
<li>当路由器收到路由通告时，它会检查自身的 AS 号是否已在 AS 路径中。如果已存在，则检测到环路，该路由通告将被丢弃。</li>
<li>路由通告的传递方向与流量的传递方向相反。</li>
</ul>
<p><img alt="" src="pic/4-45.png" /></p>
<p><strong>BGP Example</strong></p>
<p>AS2、AS3 和 AS4 都是 AS1 的客户，它们从 AS1 购买传输服务。</p>
<ul>
<li>当源 A 向目标 C 发送数据时，数据包会先经过 AS2，再经过 AS1，最终到达 AS4。</li>
<li>AS4 将 C 作为目标地址通告给其传输服务提供商 AS1，以便源地址可以通过 AS1 到达 C。之后，AS1 会将到达 C 的路由通告给包括 AS2 在内的其他客户，告知这些客户可以通过 AS1 向 C 发送流量。</li>
</ul>
<p>AS2 从 AS1 购买传输服务 (TR)，从 AS3 购买对等服务 (PE)。对等连接并非传输服务。尽管 AS2 与 AS3 建立了对等连接，AS3 又与 AS4 建立了对等连接，但这并不意味着 AS2 是通过 AS3 与 AS4 建立对等连接的，即使存在物理路径。</p>
<p>即对等服务只能相互交换信息，不会帮忙转发第三方信息。</p>
<p><img alt="" src="pic/4-46.png" /></p>
<p><strong>BGP Policy</strong></p>
<p>该策略通过两种方式实施：</p>
<ul>
<li>ISP 的边界路由器仅向可以使用这些路径的其他方通告路径，过滤掉其他方无法使用的路径</li>
<li>ISP 的边界路由器从所有已接收到的路径中选择最佳路径（非最短路径），如热点路由（提前退出）</li>
</ul>
<h2 id="mpls-multiprotocol-label-switching">MPLS (Multiprotocol Label Switching)<a class="headerlink" href="#mpls-multiprotocol-label-switching" title="Permanent link">&para;</a></h2>
<p>MPLS与电路交换非常相似。</p>
<ul>
<li>为了提高 IP 路由器的转发速度，采用了虚拟电路网络中的一个关键概念：固定长度标签(<strong>a fixed-lengt label</strong>)。</li>
<li>目标并非放弃基于目的地的 IP 数据报转发基础设施，转而采用基于固定长度标签和虚拟电路的基础设施，而是通过选择性地标记数据报来增强现有基础设施，并<strong>允许路由器在可能的情况下基于固定长度标签（而非目的地 IP 地址）转发数据报。</strong></li>
</ul>
<h4 id="where-does-the-label-go">Where Does the Label Go<a class="headerlink" href="#where-does-the-label-go" title="Permanent link">&para;</a></h4>
<p>由于 IP 数据包并非为虚拟电路而设计，因此 IP 报头中没有用于存储虚拟电路编号的字段。需要在第 2 层（即 PPP 或以太网）报头和第 3 层（即 IP）报头之间添加一个新的 MPLS 报头。</p>
<p><img alt="" src="pic/4-47.png" /></p>
<p>通用的 MPLS 报头长度为 4 字节，包含四个字段：</p>
<ul>
<li>The Label field</li>
<li>The QoS field</li>
<li>The S field (用于堆叠(stacking)多个标签)</li>
<li>The TtL field (在每个路由器处递减，如果达到 0，则丢弃该数据包)</li>
</ul>
<p><strong>MPLS 位于网络层协议和数据链路层协议之间。被称为2.5层协议</strong></p>
<ul>
<li>它实际上并非三层协议，因为它依赖于 IP 或其他网络层地址来建立标签路径。</li>
<li>它实际上也并非二层协议，因为它转发数据包需要经过多个跃点，而不是单个链路。</li>
</ul>
<p>当MPLS增强型数据包到达LSR（<strong>Label Switched Router</strong>）时，标签被用作索引，以确定要使用的出站线路以及要使用的新标签。</p>
<ul>
<li>标签必须在每一跳处重新映射。（标签仅具有本地意义）</li>
<li>所有虚电路网络都使用标签交换。</li>
<li>IP转发使用最长匹配前缀算法。相比之下，使用从数据包中提取的标签作为索引来交换转发信息，这种方法更简单、更快速。</li>
</ul>
<h4 id="when-and-how-the-labels-are-attached-to-packets">When and How the Labels are Attached to Packets<a class="headerlink" href="#when-and-how-the-labels-are-attached-to-packets" title="Permanent link">&para;</a></h4>
<p>当 IP 数据包到达 MPLS 网络边缘时，标签就会附加到数据包上。标签边缘路由器 (<strong>LER</strong>, Label Edge Router) 会检查目标 IP 地址和其他字段，以确定数据包应遵循的 MPLS 路径，并在数据包前端添加正确的标签。在 MPLS 网络内部，标签用于转发数据包。在 MPLS 网络的另一端，标签已完成其使命，将被移除，从而使 IP 数据包再次暴露出来，以便发送到下一个网络。</p>
<p><img alt="" src="pic/4-48.png" /></p>
<p>MPLS 可以通过在数据包前端添加多个标签来同时在多个层级上运行。</p>
<ul>
<li>例如，假设有许多数据包已经带有不同的标签（因为希望在网络中的某些地方区别对待这些数据包），它们应该沿着一条共同的路径到达某个目的地。与其为每个不同的标签设置一条标签交换路径，我们可以设置一条单一的路径。当已标记的数据包到达这条路径的起点时，会在数据包前端添加另一个标签。(标签栈)</li>
<li>MPLS报头中的S字段允许路由器在移除标签时知道是否还有剩余的标签。对于最底层的标签，S 位设置为 1；对于所有其他标签，S 位设置为 0。</li>
</ul>
<h4 id="how-the-label-forwarding-tables-are-set-up">How the Label Forwarding Tables are Set Up<a class="headerlink" href="#how-the-label-forwarding-tables-are-set-up" title="Permanent link">&para;</a></h4>
<p>MPLS 不需要用户参与建立连接阶段。转发信息由路由协议和连接建立协议的组合协议来建立。</p>
<p>路由器启动时，会检查哪些路由是其最终目的地（例如，哪些前缀属于其接口）。然后，它会为这些路由创建一个或多个 FEC（Forwarding Equivalent Class），为每个 FEC 分配一个标签，并将这些标签传递给其邻居。邻居们依次将这些标签添加到它们的转发表中，并向邻居发送新的标签，直到所有路由器都获取到该路径为止。</p>
<p><img alt="" src="pic/4-49.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "content.code.annotate", "navigation.indexes", "navigation.top", "toc.follow", "search.suggest", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../window.MathJax = {
  tex: {
    inlineMath: [[&#39;$&#39;, &#39;$&#39;], [&#39;/(&#39;, &#39;/)&#39;]],
    displayMath: [[&#39;$$&#39;, &#39;$$&#39;], [&#39;/[&#39;, &#39;/]&#39;]]
  }
};
"></script>
      
    
  </body>
</html>